<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>New Job Application - {{ application.get_position_display }}</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            color: #333;
            margin: 0;
            padding: 0;
            background-color: #f8f9fa;
        }
        
        .email-container {
            max-width: 600px;
            margin: 0 auto;
            background-color: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .header {
            background: linear-gradient(135deg, #0f238d, #ff9d00);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            margin: 0;
            font-size: 28px;
            font-weight: 700;
        }
        
        .header p {
            margin: 10px 0 0 0;
            font-size: 16px;
            opacity: 0.9;
        }
        
        .alert-badge {
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            margin-top: 15px;
            display: inline-block;
        }
        
        .content {
            padding: 30px;
        }
        
        .application-summary {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 25px;
            margin: 25px 0;
            border-left: 4px solid #ff9d00;
        }
        
        .application-summary h2 {
            color: #0f238d;
            margin: 0 0 20px 0;
            font-size: 24px;
        }
        
        .details-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .detail-item {
            background: white;
            padding: 15px;
            border-radius: 5px;
            border: 1px solid #e9ecef;
        }
        
        .detail-label {
            font-weight: 600;
            color: #0f238d;
            font-size: 14px;
            margin-bottom: 5px;
        }
        
        .detail-value {
            color: #666;
            font-size: 16px;
        }
        
        .cover-letter-section {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            border-radius: 8px;
            padding: 20px;
            margin: 25px 0;
        }
        
        .cover-letter-section h3 {
            color: #1976d2;
            margin: 0 0 15px 0;
        }
        
        .cover-letter-text {
            background: white;
            padding: 15px;
            border-radius: 5px;
            border-left: 3px solid #2196f3;
            font-style: italic;
            line-height: 1.6;
        }
        
        .resume-section {
            background: #fff3e0;
            border: 1px solid #ff9800;
            border-radius: 8px;
            padding: 20px;
            margin: 25px 0;
            text-align: center;
        }
        
        .resume-section h3 {
            color: #f57c00;
            margin: 0 0 15px 0;
        }
        
        .resume-info {
            color: #666;
            margin: 10px 0;
        }

        .download-btn {
            display: inline-block;
            background: linear-gradient(135deg, #0f238d, #ff9d00);
            color: white;
            padding: 12px 25px;
            border-radius: 25px;
            text-decoration: none;
            font-weight: 600;
            margin: 15px 10px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(23, 11, 44, 0.3);
        }

        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(23, 11, 44, 0.4);
            color: white;
            text-decoration: none;
        }

        .download-btn i {
            margin-right: 8px;
        }

        .file-info {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            text-align: left;
        }

        .file-name {
            font-weight: 600;
            color: #0f238d;
            margin-bottom: 5px;
        }

        .file-details {
            color: #666;
            font-size: 14px;
        }
        
        .action-buttons {
            text-align: center;
            margin: 30px 0;
        }
        
        .btn {
            display: inline-block;
            padding: 12px 25px;
            border-radius: 25px;
            text-decoration: none;
            font-weight: 600;
            margin: 0 10px;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: #0f238d;
            color: white;
        }
        
        .btn-secondary {
            background: #ff9d00;
            color: white;
        }

        .btn-info {
            background: #17a2b8;
            color: white;
        }
        
        .footer {
            background: #f8f9fa;
            padding: 25px;
            text-align: center;
            border-top: 1px solid #e9ecef;
        }
        
        .footer p {
            margin: 5px 0;
            color: #666;
            font-size: 14px;
        }
        
        @media (max-width: 600px) {
            .details-grid {
                grid-template-columns: 1fr;
            }
            
            .btn {
                display: block;
                margin: 10px 0;
            }
        }
    </style>
</head>
<body>
    <div class="email-container">
        <!-- Header -->
        <div class="header">
            <h1>üö® New Job Application</h1>
            <p>A new application has been received for {{ application.get_position_display }}</p>
            <div class="alert-badge">REVIEW REQUIRED</div>
        </div>
        
        <!-- Content -->
        <div class="content">
            <p>Hello HR Team,</p>
            
            <p>A new job application has been submitted through the Novustell Travel careers page. Please review the details below and take appropriate action.</p>
            
            <!-- Application Summary -->
            <div class="application-summary">
                <h2>üìã Application Summary</h2>
                
                <div class="details-grid">
                    <div class="detail-item">
                        <div class="detail-label">Applicant Name</div>
                        <div class="detail-value">{{ application.full_name }}</div>
                    </div>
                    
                    <div class="detail-item">
                        <div class="detail-label">Position</div>
                        <div class="detail-value">{{ application.get_position_display }}</div>
                    </div>
                    
                    <div class="detail-item">
                        <div class="detail-label">Email</div>
                        <div class="detail-value">{{ application.email }}</div>
                    </div>
                    
                    <div class="detail-item">
                        <div class="detail-label">Primary Phone</div>
                        <div class="detail-value">{{ application.phone_number }}</div>
                    </div>

                    {% if application.alternative_phone_number %}
                    <div class="detail-item">
                        <div class="detail-label">Alternative Phone</div>
                        <div class="detail-value">{{ application.alternative_phone_number }}</div>
                    </div>
                    {% endif %}
                    
                    <div class="detail-item">
                        <div class="detail-label">Experience</div>
                        <div class="detail-value">{{ application.years_of_experience }} year{{ application.years_of_experience|pluralize }}</div>
                    </div>
                    
                    <div class="detail-item">
                        <div class="detail-label">Available From</div>
                        <div class="detail-value">{{ application.availability_date|date:"F d, Y" }}</div>
                    </div>
                </div>
                
                <div class="detail-item" style="margin-top: 20px;">
                    <div class="detail-label">Application Date</div>
                    <div class="detail-value">{{ application.created_at|date:"F d, Y \a\t g:i A" }}</div>
                </div>
            </div>
            
            <!-- Cover Letter -->
            <div class="cover-letter-section">
                <h3>üìù Cover Letter</h3>
                <div class="cover-letter-text">
                    {{ application.cover_letter|linebreaks }}
                </div>
            </div>
            
            <!-- Resume Information -->
            <div class="resume-section">
                <h3>üìÑ Resume/CV</h3>
                {% if application.resume %}
                    <div class="file-info">
                        <div class="file-name">
                            üìé {{ application.resume.name|default:"Resume.pdf" }}
                        </div>
                        <div class="file-details">
                            Uploaded by {{ application.full_name }}
                        </div>
                    </div>

                    <!-- Download and Share Buttons -->
                    <div class="resume-actions" style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <a href="{{ application.resume.url }}" class="download-btn" target="_blank" rel="noopener noreferrer">
                            <i class="fas fa-download"></i>Download Resume
                        </a>
                        <button onclick="copyResumeLink()" class="share-btn" style="background: #17a2b8; color: white; border: none; padding: 12px 20px; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;">
                            <i class="fas fa-share-alt"></i>Copy CV Link
                        </button>
                    </div>

                    <script>
                        function copyResumeLink() {
                            const resumeUrl = "{{ application.resume.url }}";
                            navigator.clipboard.writeText(resumeUrl).then(function() {
                                // Change button text temporarily
                                const btn = event.target.closest('button');
                                const originalText = btn.innerHTML;
                                btn.innerHTML = '<i class="fas fa-check"></i>Copied!';
                                btn.style.background = '#28a745';
                                setTimeout(() => {
                                    btn.innerHTML = originalText;
                                    btn.style.background = '#17a2b8';
                                }, 2000);
                            }).catch(function(err) {
                                console.error('Could not copy text: ', err);
                                alert('Resume URL: {{ application.resume.url }}');
                            });
                        }
                    </script>

                    <div style="margin-top: 15px;">
                        <small style="color: #666;">
                            üí° <strong>Tip:</strong> Click the download button above to view or save the resume file directly.
                            The file will open in a new tab for easy access.
                        </small>
                    </div>
                {% else %}
                    <div class="resume-info">
                        <em>‚ùå No resume file uploaded</em>
                        <br><small>The applicant did not upload a resume with their application.</small>
                    </div>
                {% endif %}
            </div>
            
            <!-- Action Buttons -->
            <div class="action-buttons">
                <a href="{% url 'admin:users_jobapplication_change' application.id %}" class="btn btn-primary" target="_blank" rel="noopener noreferrer">
                    üè† View in Admin Panel
                </a>
                <a href="mailto:{{ application.email }}?subject=Re: Your Application for {{ application.get_position_display }}&body=Dear {{ application.full_name }},%0D%0A%0D%0AThank you for your application for the {{ application.get_position_display }} position at Novustell Travel.%0D%0A%0D%0A" class="btn btn-secondary">
                    ‚úâÔ∏è Contact Applicant
                </a>
                {% if application.alternative_phone_number %}
                <a href="tel:{{ application.alternative_phone_number }}" class="btn btn-info">
                    üìû Call Alternative
                </a>
                {% endif %}
                <a href="tel:{{ application.phone_number }}" class="btn btn-info">
                    üìû Call Primary
                </a>
            </div>
            
            <div style="background: #e8f5e8; border: 1px solid #4caf50; border-radius: 8px; padding: 20px; margin: 25px 0; text-align: center;">
                <h3 style="color: #2e7d32; margin: 0 0 15px 0;">üìä Next Steps</h3>
                <p style="color: #666; margin: 0; line-height: 1.6;">
                    1. {% if application.resume %}Click the download button above to review the resume{% else %}Note: No resume was uploaded with this application{% endif %}<br>
                    2. Review the application details and cover letter<br>
                    3. Contact the applicant at {{ application.email }} if interested<br>
                    4. Update the application status in the admin panel
                </p>
            </div>
        </div>
        
        <!-- Footer -->
        <div class="footer">
            <p><strong>Novustell Travel HR System</strong></p>
            <p>Automated notification from careers@mbuganiluxeadventures.com</p>
            <p style="font-size: 12px; color: #999;">
                This email was automatically generated when a job application was submitted through the website.
            </p>
        </div>
    </div>
</body>
</html>
