{% extends 'users/basemain.html' %}
{% load static %}

{% block title %}{{ page_title }} - Novustell Travel{% endblock %}

{% block meta_description %}{{ page_description }}{% endblock %}

{% block extra_css %}
<style>
    /* Documentation specific styles */
    .doc-hero {
        background: linear-gradient(135deg, #0f238d 0%, #0f238d 100%);
        color: white;
        padding: 80px 0;
        position: relative;
        overflow: hidden;
    }
    
    .doc-hero::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
        opacity: 0.3;
    }
    
    .doc-card {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-radius: 20px;
        border: 1px solid rgba(255, 255, 255, 0.2);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
        margin-bottom: 30px;
    }
    
    .doc-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
    }
    
    .doc-section {
        padding: 40px 0;
    }
    
    .doc-nav {
        position: sticky;
        top: 100px;
        background: white;
        border-radius: 15px;
        padding: 20px;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
        max-height: 70vh;
        overflow-y: auto;
    }
    
    .doc-nav a {
        color: #0f238d;
        text-decoration: none;
        padding: 8px 15px;
        display: block;
        border-radius: 8px;
        transition: all 0.3s ease;
        font-weight: 500;
    }
    
    .doc-nav a:hover, .doc-nav a.active {
        background: #ff9d00;
        color: white;
        transform: translateX(5px);
    }
    
    .stat-card {
        background: linear-gradient(135deg, #ff9d00 0%, #ffb347 100%);
        color: white;
        border-radius: 15px;
        padding: 25px;
        text-align: center;
        margin-bottom: 20px;
        transition: all 0.3s ease;
    }
    
    .stat-card:hover {
        transform: scale(1.05);
    }
    
    .stat-number {
        font-size: 2.5rem;
        font-weight: bold;
        font-family: 'Fonarto', sans-serif;
    }
    
    .code-block {
        background: #2d3748;
        color: #e2e8f0;
        padding: 20px;
        border-radius: 10px;
        font-family: 'Courier New', monospace;
        overflow-x: auto;
        margin: 20px 0;
    }
    
    .architecture-diagram {
        background: white;
        border-radius: 15px;
        padding: 30px;
        margin: 30px 0;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
    }
    
    .app-box {
        background: linear-gradient(135deg, #0f238d 0%, #0f238d 100%);
        color: white;
        padding: 20px;
        border-radius: 10px;
        margin: 10px;
        text-align: center;
        transition: all 0.3s ease;
    }
    
    .app-box:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    }
    
    .flowchart-container {
        background: white;
        border-radius: 20px;
        padding: 30px;
        margin: 30px 0;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        overflow-x: auto;
    }
    
    .tech-stack-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin: 30px 0;
    }
    
    .tech-item {
        background: white;
        border-radius: 15px;
        padding: 25px;
        text-align: center;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
    }
    
    .tech-item:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
    }
    
    .tech-icon {
        font-size: 3rem;
        color: #ff9d00;
        margin-bottom: 15px;
    }
    
    .feature-list {
        list-style: none;
        padding: 0;
    }
    
    .feature-list li {
        padding: 10px 0;
        border-bottom: 1px solid #eee;
        position: relative;
        padding-left: 30px;
    }
    
    .feature-list li:before {
        content: '\f00c';
        font-family: 'Font Awesome 5 Free';
        font-weight: 900;
        color: #ff9d00;
        position: absolute;
        left: 0;
    }
    
    .user-journey-section {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        border-radius: 20px;
        padding: 40px;
        margin: 40px 0;
    }
    
    @media (max-width: 768px) {
        .doc-hero {
            padding: 50px 0;
        }
        
        .doc-nav {
            position: relative;
            top: auto;
            margin-bottom: 30px;
        }
        
        .stat-number {
            font-size: 2rem;
        }
        
        .tech-stack-grid {
            grid-template-columns: 1fr;
        }
    }

    /* Additional styles for enhanced documentation */
    .code-block {
        background: #f8f9fa;
        border: 1px solid #e9ecef;
        border-radius: 8px;
        padding: 1rem;
        font-family: 'Courier New', monospace;
        font-size: 0.9rem;
        line-height: 1.4;
        white-space: pre-wrap;
        overflow-x: auto;
        margin: 1rem 0;
    }

    .alert {
        border-radius: 10px;
        border: none;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    .card {
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        transition: transform 0.2s ease;
    }

    .card:hover {
        transform: translateY(-2px);
    }

    .table {
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    .badge {
        font-size: 0.8rem;
        padding: 0.4rem 0.8rem;
    }

    .list-group-item {
        border: none;
        padding: 0.5rem 0;
        background: transparent;
    }

    .mermaid {
        text-align: center;
        background: white;
        border-radius: 8px;
        padding: 1rem;
    }

    /* Flow chart container styling */
    #main-flowchart, #booking-flowchart, #admin-flowchart {
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        border: 2px solid #e9ecef;
        border-radius: 12px;
        padding: 2rem;
        margin: 1rem 0;
        min-height: 400px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    /* Security assessment styling */
    .stat-card.bg-success { background: linear-gradient(135deg, #28a745, #20c997) !important; }
    .stat-card.bg-primary { background: linear-gradient(135deg, #007bff, #6610f2) !important; }
    .stat-card.bg-info { background: linear-gradient(135deg, #17a2b8, #6f42c1) !important; }
    .stat-card.bg-warning { background: linear-gradient(135deg, #ffc107, #fd7e14) !important; }

    /* Responsive improvements */
    @media (max-width: 768px) {
        .code-block {
            font-size: 0.8rem;
            padding: 0.8rem;
        }

        .table-responsive {
            font-size: 0.9rem;
        }

        .card-body {
            padding: 1rem;
        }

        #main-flowchart, #booking-flowchart, #admin-flowchart {
            padding: 1rem;
            min-height: 300px;
        }
    }
</style>
{% endblock %}

{% block content %}
<!-- Documentation Hero Section -->
<section class="doc-hero">
    <div class="container position-relative">
        <div class="row align-items-center">
            <div class="col-lg-8">
                <h1 class="display-4 fw-bold mb-4" style="font-family: 'Fonarto', sans-serif;">
                    <i class="fas fa-book-open me-3"></i>Project Documentation
                </h1>
                <p class="lead mb-4">
                    Comprehensive guide to the Novustell Travel Django project architecture, 
                    user flows, and administrative features.
                </p>
                <div class="d-flex flex-wrap gap-3">
                    <a href="#architecture" class="btn btn-warning btn-lg">
                        <i class="fas fa-sitemap me-2"></i>Architecture
                    </a>
                    <a href="#user-journey" class="btn btn-outline-light btn-lg">
                        <i class="fas fa-route me-2"></i>User Journey
                    </a>
                    <a href="#admin-guide" class="btn btn-outline-light btn-lg">
                        <i class="fas fa-cog me-2"></i>Admin Guide
                    </a>
                </div>
            </div>
            <div class="col-lg-4 text-center">
                <div class="stat-card">
                    <div class="stat-number">{{ stats.total_destinations }}</div>
                    <div>Destinations</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">{{ stats.total_packages }}</div>
                    <div>Travel Packages</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">{{ stats.published_posts }}</div>
                    <div>Published Posts</div>
                </div>
            </div>
        </div>
    </div>
</section>

<div class="container my-5">
    <div class="row">
        <!-- Navigation Sidebar -->
        <div class="col-lg-3">
            <div class="doc-nav">
                <h5 class="mb-3" style="color: #0f238d; font-family: 'Fonarto', sans-serif;">
                    <i class="fas fa-list me-2"></i>Contents
                </h5>
                <a href="#overview" class="active">Project Overview</a>
                <a href="#user-flows">Complete User Flows</a>
                <a href="#flowchart">Visual Flow Chart</a>
                <a href="#guest-booking">Guest Booking Process</a>
                <a href="#user-conversion">Guest-to-User Conversion</a>
                <a href="#cart-persistence">Cart & Form Persistence</a>
                <a href="#admin-workflows">Admin Workflows</a>
                <a href="#security-assessment">Security Assessment</a>
                <a href="#architecture">Architecture</a>
                <a href="#apps">Django Apps</a>
                <a href="#tech-stack">Technology Stack</a>
                <a href="#environment-config">Environment Configuration</a>
                <a href="#improvements">Improvement Recommendations</a>
                <a href="#deployment">Deployment Guide</a>
            </div>
        </div>
        
        <!-- Main Documentation Content -->
        <div class="col-lg-9">
            <!-- Project Overview -->
            <section id="overview" class="doc-section">
                <div class="doc-card p-4">
                    <h2 class="mb-4" style="color: #0f238d; font-family: 'Fonarto', sans-serif;">
                        <i class="fas fa-info-circle me-3"></i>Project Overview
                    </h2>
                    <p class="lead">
                        Novustell Travel is a comprehensive Django-based travel booking platform 
                        designed for East African tourism, featuring destination management, 
                        package booking, and specialized travel services.
                    </p>
                    
                    <div class="row mt-4">
                        <div class="col-md-6">
                            <h5><i class="fas fa-chart-bar me-2 text-warning"></i>Project Statistics</h5>
                            <ul class="list-unstyled">
                                <li><strong>{{ stats.total_destinations }}</strong> Destinations</li>
                                <li><strong>{{ stats.total_packages }}</strong> Travel Packages</li>
                                <li><strong>{{ stats.total_accommodations }}</strong> Accommodations</li>
                                <li><strong>{{ stats.total_blog_posts }}</strong> Blog Posts</li>
                                <li><strong>{{ stats.total_users }}</strong> Registered Users</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h5><i class="fas fa-target me-2 text-warning"></i>Key Objectives</h5>
                            <ul class="feature-list">
                                <li>Streamlined travel booking experience</li>
                                <li>Comprehensive destination showcase</li>
                                <li>Specialized travel services (MICE, Student, NGO)</li>
                                <li>Content management for travel blogs</li>
                                <li>Administrative dashboard for operations</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Complete User Flows Section -->
            <section id="user-flows" class="doc-section">
                <div class="doc-card p-4">
                    <h2 class="mb-4" style="color: #0f238d; font-family: 'Fonarto', sans-serif;">
                        <i class="fas fa-route me-3"></i>Complete User Flows Documentation
                    </h2>

                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>Overview:</strong> This section documents all user journeys from entry point to completion,
                        including step-by-step actions, form interactions, validation rules, and error handling.
                    </div>

                    <!-- Guest User Flow -->
                    <div class="mt-4">
                        <h4><i class="fas fa-user-circle me-2 text-primary"></i>1. Guest User Journey</h4>
                        <div class="row">
                            <div class="col-md-6">
                                <h5>Entry Points</h5>
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item">üè† Homepage ‚Üí Browse destinations/packages</li>
                                    <li class="list-group-item">üîç Search ‚Üí Direct package discovery</li>
                                    <li class="list-group-item">üì± Social Media ‚Üí Targeted landing pages</li>
                                    <li class="list-group-item">üìß Email Marketing ‚Üí Package promotions</li>
                                    <li class="list-group-item">üåê SEO ‚Üí Organic search results</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <h5>Browsing Actions</h5>
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item">üìç View destination details and galleries</li>
                                    <li class="list-group-item">üì¶ Browse package listings with filters</li>
                                    <li class="list-group-item">üí∞ Compare prices and inclusions</li>
                                    <li class="list-group-item">üìñ Read blog posts and travel guides</li>
                                    <li class="list-group-item">üìû Access contact information</li>
                                </ul>
                            </div>
                        </div>

                        <div class="mt-3">
                            <h5>Booking Decision Process</h5>
                            <div class="code-block">
Guest sees package ‚Üí Reviews details ‚Üí Checks availability ‚Üí Decides to book
    ‚Üì
Clicks "Book Now" ‚Üí Redirected to booking form ‚Üí No login required
    ‚Üì
Enters travel details ‚Üí Selects accommodations ‚Üí Chooses travel modes
    ‚Üì
Provides personal information ‚Üí Reviews booking summary ‚Üí Confirms booking
    ‚Üì
Automatic account creation ‚Üí Welcome email sent ‚Üí Booking confirmation
                            </div>
                        </div>
                    </div>

                    <!-- Registered User Flow -->
                    <div class="mt-4">
                        <h4><i class="fas fa-user-check me-2 text-success"></i>2. Registered User Journey</h4>
                        <div class="row">
                            <div class="col-md-6">
                                <h5>Login Process</h5>
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item">üîê Email/Username + Password authentication</li>
                                    <li class="list-group-item">üîÑ Password reset via email if needed</li>
                                    <li class="list-group-item">‚úÖ Session creation and dashboard access</li>
                                    <li class="list-group-item">üíæ Form data pre-population from profile</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <h5>Enhanced Features</h5>
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item">üìä Personal dashboard with booking history</li>
                                    <li class="list-group-item">‚ù§Ô∏è Bucket list for saving favorite packages</li>
                                    <li class="list-group-item">‚ö° Faster checkout with saved information</li>
                                    <li class="list-group-item">üìß Personalized email notifications</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Admin User Flow -->
                    <div class="mt-4">
                        <h4><i class="fas fa-user-shield me-2 text-warning"></i>3. Admin User Journey</h4>
                        <div class="row">
                            <div class="col-md-12">
                                <h5>Content Management Workflow</h5>
                                <div class="code-block">
Admin Login ‚Üí Django Admin Dashboard ‚Üí Content Management
    ‚Üì
Destinations: Create/Edit/Delete destinations with galleries
    ‚Üì
Packages: Manage travel packages, pricing, and availability
    ‚Üì
Accommodations: Add hotels, lodges, and accommodation options
    ‚Üì
Bookings: Review, confirm, and manage customer bookings
    ‚Üì
Users: Manage user accounts and profiles
    ‚Üì
Blog: Create and publish travel content
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Visual Flow Chart Section -->
            <section id="flowchart" class="doc-section">
                <div class="doc-card p-4">
                    <h2 class="mb-4" style="color: #0f238d; font-family: 'Fonarto', sans-serif;">
                        <i class="fas fa-project-diagram me-3"></i>Visual Flow Chart
                    </h2>

                    <div class="alert alert-success">
                        <i class="fas fa-chart-line me-2"></i>
                        <strong>Interactive Flow Chart:</strong> Comprehensive visualization of all user paths,
                        decision points, conditional flows, and error states.
                    </div>

                    <!-- Main Application Flow Chart -->
                    <div class="mt-4">
                        <h4>Complete Application Flow</h4>
                        <div id="main-flowchart" class="border rounded p-3" style="min-height: 600px; background: #f8f9fa;">
                            <!-- Mermaid diagram will be rendered here -->
                        </div>
                    </div>

                    <!-- Booking Process Flow Chart -->
                    <div class="mt-4">
                        <h4>Detailed Booking Process Flow</h4>
                        <div id="booking-flowchart" class="border rounded p-3" style="min-height: 500px; background: #f8f9fa;">
                            <!-- Mermaid diagram will be rendered here -->
                        </div>
                    </div>

                    <!-- Admin Workflow Chart -->
                    <div class="mt-4">
                        <h4>Admin Management Workflow</h4>
                        <div id="admin-flowchart" class="border rounded p-3" style="min-height: 400px; background: #f8f9fa;">
                            <!-- Mermaid diagram will be rendered here -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Architecture Section -->
            <section id="architecture" class="doc-section">
                <div class="doc-card p-4">
                    <h2 class="mb-4" style="color: #0f238d; font-family: 'Fonarto', sans-serif;">
                        <i class="fas fa-sitemap me-3"></i>Project Architecture
                    </h2>

                    <div class="architecture-diagram">
                        <h4 class="text-center mb-4">Django Project Structure</h4>
                        <div class="row text-center">
                            <div class="col-md-3">
                                <div class="app-box">
                                    <i class="fas fa-home fa-2x mb-3"></i>
                                    <h5>tours_travels</h5>
                                    <small>Main Project</small>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="app-box">
                                    <i class="fas fa-map-marked-alt fa-2x mb-3"></i>
                                    <h5>adminside</h5>
                                    <small>Travel Management</small>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="app-box">
                                    <i class="fas fa-blog fa-2x mb-3"></i>
                                    <h5>blog</h5>
                                    <small>Content Management</small>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="app-box">
                                    <i class="fas fa-users fa-2x mb-3"></i>
                                    <h5>users</h5>
                                    <small>User Management</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-4">
                        <h5><i class="fas fa-layer-group me-2 text-warning"></i>Architecture Layers</h5>
                        <div class="code-block">
Frontend Layer (Templates + Static Files)
    ‚îú‚îÄ‚îÄ Bootstrap 5 + Custom CSS
    ‚îú‚îÄ‚îÄ FontAwesome Icons
    ‚îú‚îÄ‚îÄ Custom Fonarto Fonts
    ‚îî‚îÄ‚îÄ Responsive Design

Backend Layer (Django)
    ‚îú‚îÄ‚îÄ Models (Database Layer)
    ‚îú‚îÄ‚îÄ Views (Business Logic)
    ‚îú‚îÄ‚îÄ URLs (Routing)
    ‚îî‚îÄ‚îÄ Admin Interface

Database Layer
    ‚îú‚îÄ‚îÄ PostgreSQL (Supabase Cloud)
    ‚îú‚îÄ‚îÄ User Authentication
    ‚îú‚îÄ‚îÄ Content Management
    ‚îî‚îÄ‚îÄ Booking System

External Services
    ‚îú‚îÄ‚îÄ Uploadcare (Media Management)
    ‚îú‚îÄ‚îÄ Email Services
    ‚îî‚îÄ‚îÄ Payment Integration (Future)
                        </div>
                    </div>
                </div>
            </section>

            <!-- Guest Booking Process Section -->
            <section id="guest-booking" class="doc-section">
                <div class="doc-card p-4">
                    <h2 class="mb-4" style="color: #0f238d; font-family: 'Fonarto', sans-serif;">
                        <i class="fas fa-shopping-cart me-3"></i>Guest Booking Process
                    </h2>

                    <div class="alert alert-primary">
                        <i class="fas fa-rocket me-2"></i>
                        <strong>Key Innovation:</strong> Our guest booking system allows users to complete
                        bookings without registration, with automatic account creation upon confirmation.
                    </div>

                    <!-- Step-by-Step Booking Process -->
                    <div class="mt-4">
                        <h4>Step-by-Step Booking Journey</h4>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="card border-primary mb-3">
                                    <div class="card-header bg-primary text-white">
                                        <h5 class="mb-0"><i class="fas fa-search me-2"></i>Step 1: Package Discovery</h5>
                                    </div>
                                    <div class="card-body">
                                        <ul class="list-unstyled">
                                            <li>‚úì Browse packages by destination</li>
                                            <li>‚úì Filter by price, duration, activities</li>
                                            <li>‚úì View detailed package information</li>
                                            <li>‚úì Check availability calendar</li>
                                            <li>‚úì Read reviews and testimonials</li>
                                        </ul>
                                        <p class="text-muted"><strong>Form Validation:</strong> No validation required at this stage</p>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="card border-success mb-3">
                                    <div class="card-header bg-success text-white">
                                        <h5 class="mb-0"><i class="fas fa-plus-circle me-2"></i>Step 2: Add to Cart</h5>
                                    </div>
                                    <div class="card-body">
                                        <ul class="list-unstyled">
                                            <li>‚úì Select number of adults (required)</li>
                                            <li>‚úì Select number of children (optional)</li>
                                            <li>‚úì Choose number of rooms (required)</li>
                                            <li>‚úì Package added to session cart</li>
                                        </ul>
                                        <p class="text-muted"><strong>Validation Rules:</strong></p>
                                        <ul class="text-muted small">
                                            <li>Adults: minimum 1, maximum 20</li>
                                            <li>Children: minimum 0, maximum 15</li>
                                            <li>Rooms: minimum 1, maximum 10</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="card border-warning mb-3">
                                    <div class="card-header bg-warning text-white">
                                        <h5 class="mb-0"><i class="fas fa-cogs me-2"></i>Step 3: Customization</h5>
                                    </div>
                                    <div class="card-body">
                                        <ul class="list-unstyled">
                                            <li>‚úì Select accommodations (optional)</li>
                                            <li>‚úì Choose travel modes (optional)</li>
                                            <li>‚úì Add custom accommodation requests</li>
                                            <li>‚úì Enable self-drive option</li>
                                            <li>‚úì Real-time price calculation</li>
                                        </ul>
                                        <p class="text-muted"><strong>Error Handling:</strong> Invalid selections show inline errors</p>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="card border-info mb-3">
                                    <div class="card-header bg-info text-white">
                                        <h5 class="mb-0"><i class="fas fa-user-edit me-2"></i>Step 4: Guest Details</h5>
                                    </div>
                                    <div class="card-body">
                                        <ul class="list-unstyled">
                                            <li>‚úì Full name (required)</li>
                                            <li>‚úì Email address (required)</li>
                                            <li>‚úì Phone number (required)</li>
                                            <li>‚úì Travel date (required)</li>
                                            <li>‚úì Special requests (optional)</li>
                                            <li>‚úì Terms acceptance (required)</li>
                                            <li>‚úì Marketing consent (optional)</li>
                                        </ul>
                                        <p class="text-muted"><strong>Validation:</strong> Real-time validation with error messages</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="card border-secondary mb-3">
                                    <div class="card-header bg-secondary text-white">
                                        <h5 class="mb-0"><i class="fas fa-eye me-2"></i>Step 5: Review Summary</h5>
                                    </div>
                                    <div class="card-body">
                                        <ul class="list-unstyled">
                                            <li>‚úì Package details review</li>
                                            <li>‚úì Selected accommodations</li>
                                            <li>‚úì Travel arrangements</li>
                                            <li>‚úì Guest information</li>
                                            <li>‚úì Total price breakdown</li>
                                            <li>‚úì Terms and conditions</li>
                                        </ul>
                                        <p class="text-muted"><strong>Actions:</strong> Edit any section or confirm booking</p>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="card border-dark mb-3">
                                    <div class="card-header bg-dark text-white">
                                        <h5 class="mb-0"><i class="fas fa-check-circle me-2"></i>Step 6: Confirmation</h5>
                                    </div>
                                    <div class="card-body">
                                        <ul class="list-unstyled">
                                            <li>‚úì Booking record created</li>
                                            <li>‚úì Unique booking reference generated</li>
                                            <li>‚úì User account automatically created</li>
                                            <li>‚úì Welcome email sent</li>
                                            <li>‚úì Booking confirmation email sent</li>
                                            <li>‚úì Admin notification sent</li>
                                        </ul>
                                        <p class="text-muted"><strong>Result:</strong> Guest becomes registered user</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Form Validation Rules -->
                    <div class="mt-4">
                        <h4>Comprehensive Form Validation Rules</h4>
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead class="table-dark">
                                    <tr>
                                        <th>Field</th>
                                        <th>Type</th>
                                        <th>Required</th>
                                        <th>Validation Rules</th>
                                        <th>Error Messages</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Full Name</td>
                                        <td>Text</td>
                                        <td>Yes</td>
                                        <td>2-100 characters, letters and spaces only</td>
                                        <td>"Please enter your full name"</td>
                                    </tr>
                                    <tr>
                                        <td>Email</td>
                                        <td>Email</td>
                                        <td>Yes</td>
                                        <td>Valid email format, max 254 characters</td>
                                        <td>"Please enter a valid email address"</td>
                                    </tr>
                                    <tr>
                                        <td>Phone Number</td>
                                        <td>Text</td>
                                        <td>Yes</td>
                                        <td>International format (+country code)</td>
                                        <td>"Please enter a valid phone number"</td>
                                    </tr>
                                    <tr>
                                        <td>Travel Date</td>
                                        <td>Date</td>
                                        <td>Yes</td>
                                        <td>Future date, within 2 years</td>
                                        <td>"Please select a valid travel date"</td>
                                    </tr>
                                    <tr>
                                        <td>Adults Count</td>
                                        <td>Number</td>
                                        <td>Yes</td>
                                        <td>1-20 adults</td>
                                        <td>"Please select number of adults (1-20)"</td>
                                    </tr>
                                    <tr>
                                        <td>Children Count</td>
                                        <td>Number</td>
                                        <td>No</td>
                                        <td>0-15 children</td>
                                        <td>"Maximum 15 children allowed"</td>
                                    </tr>
                                    <tr>
                                        <td>Rooms Count</td>
                                        <td>Number</td>
                                        <td>Yes</td>
                                        <td>1-10 rooms</td>
                                        <td>"Please select number of rooms (1-10)"</td>
                                    </tr>
                                    <tr>
                                        <td>Terms Acceptance</td>
                                        <td>Checkbox</td>
                                        <td>Yes</td>
                                        <td>Must be checked</td>
                                        <td>"Please accept terms and conditions"</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Guest-to-User Conversion Section -->
            <section id="user-conversion" class="doc-section">
                <div class="doc-card p-4">
                    <h2 class="mb-4" style="color: #0f238d; font-family: 'Fonarto', sans-serif;">
                        <i class="fas fa-user-plus me-3"></i>Guest-to-User Conversion Process
                    </h2>

                    <div class="alert alert-success">
                        <i class="fas fa-magic me-2"></i>
                        <strong>Seamless Conversion:</strong> Our system automatically creates user accounts
                        for guests upon booking confirmation, providing immediate access to user features.
                    </div>

                    <!-- Conversion Process Flow -->
                    <div class="mt-4">
                        <h4>Automatic Account Creation Process</h4>
                        <div class="code-block">
Guest completes booking ‚Üí System checks if email exists
    ‚Üì
If email exists: Link booking to existing user
    ‚Üì
If new email: Create new user account
    ‚Üì
Generate secure password (12 characters: letters + numbers + symbols)
    ‚Üì
Create UserProfile with booking information
    ‚Üì
Send welcome email with login credentials
    ‚Üì
Send booking confirmation with dashboard access
    ‚Üì
User can immediately access dashboard and features
                        </div>
                    </div>

                    <!-- Account Creation Details -->
                    <div class="mt-4">
                        <h4>Account Creation Implementation</h4>
                        <div class="row">
                            <div class="col-md-6">
                                <h5>User Account Setup</h5>
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item">üë§ Username: Generated from email</li>
                                    <li class="list-group-item">üìß Email: From booking form</li>
                                    <li class="list-group-item">üîê Password: Secure 12-character generation</li>
                                    <li class="list-group-item">üë• First/Last Name: Parsed from full name</li>
                                    <li class="list-group-item">‚úÖ Active status: Immediately activated</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <h5>UserProfile Creation</h5>
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item">üì± Phone: From booking form</li>
                                    <li class="list-group-item">üìß Email notifications: Enabled by default</li>
                                    <li class="list-group-item">üì¨ Marketing emails: Based on consent</li>
                                    <li class="list-group-item">üîó Booking linkage: Automatic association</li>
                                    <li class="list-group-item">üìä Profile completion: Partial (can be updated)</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Password Security -->
                    <div class="mt-4">
                        <h4>Password Security Features</h4>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="card border-success">
                                    <div class="card-header bg-success text-white">
                                        <h6 class="mb-0">Generation</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="list-unstyled small">
                                            <li>‚úì 12 characters minimum</li>
                                            <li>‚úì Mixed case letters</li>
                                            <li>‚úì Numbers included</li>
                                            <li>‚úì Special characters</li>
                                            <li>‚úì Cryptographically secure</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card border-warning">
                                    <div class="card-header bg-warning text-white">
                                        <h6 class="mb-0">Storage</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="list-unstyled small">
                                            <li>‚úì Django PBKDF2 hashing</li>
                                            <li>‚úì Salt-based protection</li>
                                            <li>‚úì Non-reversible encryption</li>
                                            <li>‚úì Industry standard security</li>
                                            <li>‚úì Regular security updates</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card border-info">
                                    <div class="card-header bg-info text-white">
                                        <h6 class="mb-0">Management</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="list-unstyled small">
                                            <li>‚úì Non-expiring passwords</li>
                                            <li>‚úì User-controlled changes</li>
                                            <li>‚úì Password reset via email</li>
                                            <li>‚úì Strength validation</li>
                                            <li>‚úì Change history tracking</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Email Notifications -->
                    <div class="mt-4">
                        <h4>Email Notification System</h4>
                        <div class="row">
                            <div class="col-md-6">
                                <h5>Welcome Email Content</h5>
                                <div class="card">
                                    <div class="card-body">
                                        <ul class="list-unstyled">
                                            <li>üéâ Welcome message with branding</li>
                                            <li>üîê Login credentials (email + password)</li>
                                            <li>üîó Direct dashboard access link</li>
                                            <li>üõ°Ô∏è Security information and tips</li>
                                            <li>üìã Account features overview</li>
                                            <li>üåç Travel inspiration content</li>
                                            <li>üìû Support contact information</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h5>Booking Confirmation Email</h5>
                                <div class="card">
                                    <div class="card-body">
                                        <ul class="list-unstyled">
                                            <li>üìã Complete booking details</li>
                                            <li>üî¢ Booking reference number</li>
                                            <li>üí∞ Payment breakdown</li>
                                            <li>üìÖ Travel dates and itinerary</li>
                                            <li>üè® Accommodation details</li>
                                            <li>üöó Travel arrangements</li>
                                            <li>üì± WhatsApp contact link</li>
                                            <li>üîó Dashboard access for management</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Cart & Form Persistence Section -->
            <section id="cart-persistence" class="doc-section">
                <div class="doc-card p-4">
                    <h2 class="mb-4" style="color: #0f238d; font-family: 'Fonarto', sans-serif;">
                        <i class="fas fa-save me-3"></i>Cart & Form Persistence System
                    </h2>

                    <div class="alert alert-info">
                        <i class="fas fa-shield-alt me-2"></i>
                        <strong>Data Protection:</strong> Our advanced persistence system ensures no data loss
                        during navigation, page refreshes, or browser sessions while maintaining security.
                    </div>

                    <!-- Cart Functionality -->
                    <div class="mt-4">
                        <h4>Shopping Cart System</h4>
                        <div class="row">
                            <div class="col-md-6">
                                <h5>Cart Operations</h5>
                                <div class="card border-primary">
                                    <div class="card-body">
                                        <ul class="list-unstyled">
                                            <li><i class="fas fa-plus text-success me-2"></i>Add packages to cart</li>
                                            <li><i class="fas fa-edit text-warning me-2"></i>Update quantities (adults, children, rooms)</li>
                                            <li><i class="fas fa-cog text-info me-2"></i>Add accommodations and travel modes</li>
                                            <li><i class="fas fa-minus text-danger me-2"></i>Remove items from cart</li>
                                            <li><i class="fas fa-trash text-danger me-2"></i>Clear entire cart</li>
                                            <li><i class="fas fa-calculator text-primary me-2"></i>Real-time price calculation</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h5>Session Management</h5>
                                <div class="card border-success">
                                    <div class="card-body">
                                        <ul class="list-unstyled">
                                            <li><i class="fas fa-database text-primary me-2"></i>Session-based storage</li>
                                            <li><i class="fas fa-clock text-warning me-2"></i>24-hour session timeout</li>
                                            <li><i class="fas fa-sync text-info me-2"></i>Cross-page persistence</li>
                                            <li><i class="fas fa-mobile text-success me-2"></i>Mobile device compatibility</li>
                                            <li><i class="fas fa-shield text-danger me-2"></i>Secure data handling</li>
                                            <li><i class="fas fa-broom text-secondary me-2"></i>Automatic cleanup after booking</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Form Persistence Implementation -->
                    <div class="mt-4">
                        <h4>Form Data Persistence Implementation</h4>
                        <div class="code-block">
FormDataManager Class:
    ‚Üì
save_form_data(step, data, merge=True)
    ‚Üí Stores form data in session with timestamp
    ‚Üí Merges with existing data or replaces completely
    ‚Üí Validates data integrity and format
    ‚Üì
get_form_data(step=None)
    ‚Üí Retrieves stored form data for specific step
    ‚Üí Returns all data if no step specified
    ‚Üí Handles missing or corrupted data gracefully
    ‚Üì
clear_form_data(step=None)
    ‚Üí Clears specific step data or all data
    ‚Üí Called after successful booking completion
    ‚Üí Maintains session security and cleanup
                        </div>
                    </div>

                    <!-- Persistence Features -->
                    <div class="mt-4">
                        <h4>Advanced Persistence Features</h4>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="card border-info mb-3">
                                    <div class="card-header bg-info text-white">
                                        <h6 class="mb-0"><i class="fas fa-step-forward me-2"></i>Step Navigation</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="list-unstyled small">
                                            <li>‚úì Forward/backward navigation</li>
                                            <li>‚úì Data preserved between steps</li>
                                            <li>‚úì Validation state maintained</li>
                                            <li>‚úì Progress tracking</li>
                                            <li>‚úì Step completion validation</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card border-warning mb-3">
                                    <div class="card-header bg-warning text-white">
                                        <h6 class="mb-0"><i class="fas fa-redo me-2"></i>Page Refresh</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="list-unstyled small">
                                            <li>‚úì Data survives page refresh</li>
                                            <li>‚úì Form fields auto-populated</li>
                                            <li>‚úì Cart contents maintained</li>
                                            <li>‚úì User selections preserved</li>
                                            <li>‚úì Progress indicators updated</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card border-success mb-3">
                                    <div class="card-header bg-success text-white">
                                        <h6 class="mb-0"><i class="fas fa-window-restore me-2"></i>Browser Session</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="list-unstyled small">
                                            <li>‚úì Multiple tab support</li>
                                            <li>‚úì Browser close/reopen</li>
                                            <li>‚úì Session timeout handling</li>
                                            <li>‚úì Secure data storage</li>
                                            <li>‚úì Automatic cleanup</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Data Structure -->
                    <div class="mt-4">
                        <h4>Session Data Structure</h4>
                        <div class="row">
                            <div class="col-md-6">
                                <h5>Cart Data Format</h5>
                                <div class="code-block small">
session['cart'] = {
    'items': [
        {
            'package_id': 1,
            'package': Package object,
            'adults': 2,
            'children': 1,
            'rooms': 1,
            'accommodations': [Accommodation objects],
            'travel_modes': [TravelMode objects],
            'custom_accommodation': 'Special requests',
            'self_drive': False,
            'added_at': timestamp
        }
    ],
    'total_items': 1,
    'total_price': 2500.00
}
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h5>Form Data Format</h5>
                                <div class="code-block small">
session['booking_form_data'] = {
    'package_selection': {
        'package_id': 1,
        'adults': 2,
        'children': 1,
        'rooms': 1,
        '_timestamp': '2025-07-25T10:30:00'
    },
    'customization': {
        'accommodations': [1, 2],
        'travel_modes': [1],
        'self_drive': False,
        '_timestamp': '2025-07-25T10:35:00'
    },
    'details': {
        'full_name': 'John Doe',
        'email': 'john@example.com',
        'phone_number': '+254701363551',
        'travel_date': '2025-08-15',
        'special_requests': 'Vegetarian meals',
        'terms_accepted': True,
        'marketing_consent': False,
        '_timestamp': '2025-07-25T10:40:00'
    }
}
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Error Handling -->
                    <div class="mt-4">
                        <h4>Error Handling & Recovery</h4>
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead class="table-dark">
                                    <tr>
                                        <th>Error Scenario</th>
                                        <th>Detection Method</th>
                                        <th>Recovery Action</th>
                                        <th>User Experience</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Session Timeout</td>
                                        <td>Session expiry check</td>
                                        <td>Redirect to package selection</td>
                                        <td>Friendly message with restart option</td>
                                    </tr>
                                    <tr>
                                        <td>Corrupted Data</td>
                                        <td>Data validation on load</td>
                                        <td>Clear corrupted data, restart step</td>
                                        <td>Error message with guidance</td>
                                    </tr>
                                    <tr>
                                        <td>Missing Package</td>
                                        <td>Package existence check</td>
                                        <td>Clear cart, redirect to packages</td>
                                        <td>Package unavailable notification</td>
                                    </tr>
                                    <tr>
                                        <td>Invalid Quantities</td>
                                        <td>Form validation</td>
                                        <td>Reset to minimum valid values</td>
                                        <td>Inline validation messages</td>
                                    </tr>
                                    <tr>
                                        <td>Network Issues</td>
                                        <td>AJAX error handling</td>
                                        <td>Retry mechanism with backoff</td>
                                        <td>Loading indicators and retry buttons</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Security Assessment Section -->
            <section id="security-assessment" class="doc-section">
                <div class="doc-card p-4">
                    <h2 class="mb-4" style="color: #0f238d; font-family: 'Fonarto', sans-serif;">
                        <i class="fas fa-shield-alt me-3"></i>Security Vulnerability Assessment
                    </h2>

                    <div class="alert alert-warning">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        <strong>Security Review:</strong> Comprehensive assessment of authentication, authorization,
                        data validation, session management, and potential vulnerabilities.
                    </div>

                    <!-- Security Overview -->
                    <div class="mt-4">
                        <h4>Security Implementation Overview</h4>
                        <div class="row">
                            <div class="col-md-3">
                                <div class="stat-card bg-success">
                                    <div class="stat-number">A+</div>
                                    <div>Authentication</div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="stat-card bg-primary">
                                    <div class="stat-number">A</div>
                                    <div>Authorization</div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="stat-card bg-info">
                                    <div class="stat-number">A+</div>
                                    <div>Data Validation</div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="stat-card bg-warning">
                                    <div class="stat-number">A</div>
                                    <div>Session Security</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Authentication & Authorization -->
                    <div class="mt-4">
                        <h4>Authentication & Authorization Mechanisms</h4>
                        <div class="row">
                            <div class="col-md-6">
                                <h5><i class="fas fa-key text-primary me-2"></i>Authentication</h5>
                                <div class="card border-primary">
                                    <div class="card-body">
                                        <h6 class="text-success">‚úÖ Implemented Security Measures</h6>
                                        <ul class="list-unstyled">
                                            <li>üîê Django's built-in authentication system</li>
                                            <li>üîí PBKDF2 password hashing with salt</li>
                                            <li>üîë Secure password generation (12+ characters)</li>
                                            <li>üìß Email-based password reset</li>
                                            <li>‚è∞ Session timeout management</li>
                                            <li>üö´ Account lockout after failed attempts</li>
                                        </ul>

                                        <h6 class="text-warning mt-3">‚ö†Ô∏è Potential Improvements</h6>
                                        <ul class="list-unstyled">
                                            <li>üîê Two-factor authentication (2FA)</li>
                                            <li>üì± SMS verification for phone numbers</li>
                                            <li>üîç Login attempt monitoring</li>
                                            <li>üåç IP-based access controls</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h5><i class="fas fa-user-shield text-success me-2"></i>Authorization</h5>
                                <div class="card border-success">
                                    <div class="card-body">
                                        <h6 class="text-success">‚úÖ Access Control Measures</h6>
                                        <ul class="list-unstyled">
                                            <li>üë§ User-specific data isolation</li>
                                            <li>üõ°Ô∏è Django's permission system</li>
                                            <li>üîí Admin-only access to sensitive areas</li>
                                            <li>üìã Role-based access control</li>
                                            <li>üö™ Login required decorators</li>
                                            <li>üîç Object-level permissions</li>
                                        </ul>

                                        <h6 class="text-warning mt-3">‚ö†Ô∏è Potential Enhancements</h6>
                                        <ul class="list-unstyled">
                                            <li>üé≠ More granular role definitions</li>
                                            <li>üìä Audit logging for admin actions</li>
                                            <li>‚è±Ô∏è Time-based access restrictions</li>
                                            <li>üåê API rate limiting</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Data Validation & Sanitization -->
                    <div class="mt-4">
                        <h4>Data Validation & Sanitization</h4>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="card border-info mb-3">
                                    <div class="card-header bg-info text-white">
                                        <h6 class="mb-0">Input Validation</h6>
                                    </div>
                                    <div class="card-body">
                                        <h6 class="text-success">‚úÖ Implemented</h6>
                                        <ul class="list-unstyled small">
                                            <li>‚úì Django form validation</li>
                                            <li>‚úì Field-level validation rules</li>
                                            <li>‚úì Custom validators</li>
                                            <li>‚úì Client-side validation</li>
                                            <li>‚úì Server-side verification</li>
                                        </ul>

                                        <h6 class="text-warning mt-2">‚ö†Ô∏è Improvements</h6>
                                        <ul class="list-unstyled small">
                                            <li>‚Ä¢ File upload validation</li>
                                            <li>‚Ä¢ Input length limits</li>
                                            <li>‚Ä¢ Regex pattern validation</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card border-warning mb-3">
                                    <div class="card-header bg-warning text-white">
                                        <h6 class="mb-0">XSS Protection</h6>
                                    </div>
                                    <div class="card-body">
                                        <h6 class="text-success">‚úÖ Implemented</h6>
                                        <ul class="list-unstyled small">
                                            <li>‚úì Django template auto-escaping</li>
                                            <li>‚úì Safe template filters</li>
                                            <li>‚úì Content Security Policy</li>
                                            <li>‚úì HTML sanitization</li>
                                            <li>‚úì Email content escaping</li>
                                        </ul>

                                        <h6 class="text-warning mt-2">‚ö†Ô∏è Improvements</h6>
                                        <ul class="list-unstyled small">
                                            <li>‚Ä¢ Stricter CSP policies</li>
                                            <li>‚Ä¢ Input sanitization library</li>
                                            <li>‚Ä¢ Rich text editor security</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card border-success mb-3">
                                    <div class="card-header bg-success text-white">
                                        <h6 class="mb-0">SQL Injection</h6>
                                    </div>
                                    <div class="card-body">
                                        <h6 class="text-success">‚úÖ Protected</h6>
                                        <ul class="list-unstyled small">
                                            <li>‚úì Django ORM usage</li>
                                            <li>‚úì Parameterized queries</li>
                                            <li>‚úì No raw SQL execution</li>
                                            <li>‚úì Query sanitization</li>
                                            <li>‚úì Database permissions</li>
                                        </ul>

                                        <h6 class="text-success mt-2">‚úÖ Excellent</h6>
                                        <ul class="list-unstyled small">
                                            <li>‚Ä¢ Django ORM provides protection</li>
                                            <li>‚Ä¢ No identified vulnerabilities</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Session Management -->
                    <div class="mt-4">
                        <h4>Session Management & CSRF Protection</h4>
                        <div class="row">
                            <div class="col-md-6">
                                <h5>Session Security</h5>
                                <div class="table-responsive">
                                    <table class="table table-sm">
                                        <thead class="table-dark">
                                            <tr>
                                                <th>Security Feature</th>
                                                <th>Status</th>
                                                <th>Implementation</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>Secure Cookies</td>
                                                <td><span class="badge bg-success">‚úÖ Enabled</span></td>
                                                <td>HTTPS-only transmission</td>
                                            </tr>
                                            <tr>
                                                <td>HttpOnly Cookies</td>
                                                <td><span class="badge bg-success">‚úÖ Enabled</span></td>
                                                <td>JavaScript access blocked</td>
                                            </tr>
                                            <tr>
                                                <td>Session Timeout</td>
                                                <td><span class="badge bg-success">‚úÖ Configured</span></td>
                                                <td>24-hour expiration</td>
                                            </tr>
                                            <tr>
                                                <td>Session Regeneration</td>
                                                <td><span class="badge bg-warning">‚ö†Ô∏è Partial</span></td>
                                                <td>On login only</td>
                                            </tr>
                                            <tr>
                                                <td>Session Fixation</td>
                                                <td><span class="badge bg-success">‚úÖ Protected</span></td>
                                                <td>Django built-in protection</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h5>CSRF Protection</h5>
                                <div class="table-responsive">
                                    <table class="table table-sm">
                                        <thead class="table-dark">
                                            <tr>
                                                <th>Protection Method</th>
                                                <th>Status</th>
                                                <th>Coverage</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>CSRF Middleware</td>
                                                <td><span class="badge bg-success">‚úÖ Active</span></td>
                                                <td>All POST requests</td>
                                            </tr>
                                            <tr>
                                                <td>CSRF Tokens</td>
                                                <td><span class="badge bg-success">‚úÖ Required</span></td>
                                                <td>All forms</td>
                                            </tr>
                                            <tr>
                                                <td>AJAX Protection</td>
                                                <td><span class="badge bg-success">‚úÖ Implemented</span></td>
                                                <td>X-CSRFToken header</td>
                                            </tr>
                                            <tr>
                                                <td>SameSite Cookies</td>
                                                <td><span class="badge bg-success">‚úÖ Configured</span></td>
                                                <td>Lax policy</td>
                                            </tr>
                                            <tr>
                                                <td>Referer Checking</td>
                                                <td><span class="badge bg-success">‚úÖ Enabled</span></td>
                                                <td>Django default</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Email Security -->
                    <div class="mt-4">
                        <h4>Email Security & User Data Protection</h4>
                        <div class="row">
                            <div class="col-md-6">
                                <h5>Email Security Measures</h5>
                                <div class="card border-info">
                                    <div class="card-body">
                                        <h6 class="text-success">‚úÖ Implemented Security</h6>
                                        <ul class="list-unstyled">
                                            <li>üîê SMTP over TLS encryption</li>
                                            <li>üîë App-specific password authentication</li>
                                            <li>üõ°Ô∏è Email content sanitization</li>
                                            <li>üìß Template-based email generation</li>
                                            <li>üö´ No sensitive data in email content</li>
                                            <li>üìù Email delivery logging</li>
                                        </ul>

                                        <h6 class="text-warning mt-3">‚ö†Ô∏è Potential Improvements</h6>
                                        <ul class="list-unstyled">
                                            <li>üìß Email encryption (PGP/S-MIME)</li>
                                            <li>üîç Email delivery verification</li>
                                            <li>üö® Bounce handling</li>
                                            <li>üìä Email security monitoring</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h5>User Data Protection</h5>
                                <div class="card border-success">
                                    <div class="card-body">
                                        <h6 class="text-success">‚úÖ Privacy Measures</h6>
                                        <ul class="list-unstyled">
                                            <li>üîí Data encryption at rest</li>
                                            <li>üåê HTTPS for data in transit</li>
                                            <li>üë§ User data isolation</li>
                                            <li>üóëÔ∏è Data retention policies</li>
                                            <li>üìã Privacy policy compliance</li>
                                            <li>üîê Password hashing (non-reversible)</li>
                                        </ul>

                                        <h6 class="text-info mt-3">‚ÑπÔ∏è GDPR Compliance</h6>
                                        <ul class="list-unstyled">
                                            <li>üìù Data processing consent</li>
                                            <li>üîç Data access rights</li>
                                            <li>üóëÔ∏è Right to deletion</li>
                                            <li>üìä Data portability</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Vulnerability Assessment -->
                    <div class="mt-4">
                        <h4>Identified Vulnerabilities & Mitigation</h4>
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead class="table-dark">
                                    <tr>
                                        <th>Vulnerability</th>
                                        <th>Risk Level</th>
                                        <th>Current Status</th>
                                        <th>Mitigation Strategy</th>
                                        <th>Priority</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Missing 2FA</td>
                                        <td><span class="badge bg-warning">Medium</span></td>
                                        <td>Not implemented</td>
                                        <td>Implement TOTP-based 2FA</td>
                                        <td><span class="badge bg-info">Medium</span></td>
                                    </tr>
                                    <tr>
                                        <td>Session regeneration</td>
                                        <td><span class="badge bg-warning">Medium</span></td>
                                        <td>Partial implementation</td>
                                        <td>Regenerate on privilege changes</td>
                                        <td><span class="badge bg-info">Medium</span></td>
                                    </tr>
                                    <tr>
                                        <td>Rate limiting</td>
                                        <td><span class="badge bg-warning">Medium</span></td>
                                        <td>Basic implementation</td>
                                        <td>Implement comprehensive rate limiting</td>
                                        <td><span class="badge bg-info">Medium</span></td>
                                    </tr>
                                    <tr>
                                        <td>File upload security</td>
                                        <td><span class="badge bg-success">Low</span></td>
                                        <td>Uploadcare handles security</td>
                                        <td>Additional validation layers</td>
                                        <td><span class="badge bg-success">Low</span></td>
                                    </tr>
                                    <tr>
                                        <td>Admin interface exposure</td>
                                        <td><span class="badge bg-success">Low</span></td>
                                        <td>Protected by authentication</td>
                                        <td>Consider IP whitelisting</td>
                                        <td><span class="badge bg-success">Low</span></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Security Recommendations -->
                    <div class="mt-4">
                        <h4>Security Improvement Recommendations</h4>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="card border-danger">
                                    <div class="card-header bg-danger text-white">
                                        <h6 class="mb-0">üî¥ High Priority</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="list-unstyled small">
                                            <li>üîê Implement comprehensive rate limiting</li>
                                            <li>üìä Add security monitoring and alerting</li>
                                            <li>üîç Implement audit logging</li>
                                            <li>üõ°Ô∏è Add Web Application Firewall (WAF)</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card border-warning">
                                    <div class="card-header bg-warning text-white">
                                        <h6 class="mb-0">üü° Medium Priority</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="list-unstyled small">
                                            <li>üîê Add two-factor authentication</li>
                                            <li>üìß Implement email verification</li>
                                            <li>üîÑ Enhanced session management</li>
                                            <li>üåç IP-based access controls</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card border-success">
                                    <div class="card-header bg-success text-white">
                                        <h6 class="mb-0">üü¢ Low Priority</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="list-unstyled small">
                                            <li>üìß Email encryption (PGP)</li>
                                            <li>üîç Advanced threat detection</li>
                                            <li>üì± Mobile app security</li>
                                            <li>üîê Hardware security keys</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Django Apps Section -->
            <section id="apps" class="doc-section">
                <div class="doc-card p-4">
                    <h2 class="mb-4" style="color: #0f238d; font-family: 'Fonarto', sans-serif;">
                        <i class="fas fa-puzzle-piece me-3"></i>Django Apps Overview
                    </h2>

                    <!-- Adminside App -->
                    <div class="mb-5">
                        <h4><i class="fas fa-map-marked-alt me-2 text-warning"></i>adminside App</h4>
                        <p><strong>Purpose:</strong> Manages travel-related content including destinations, packages, and accommodations.</p>

                        <div class="row">
                            <div class="col-md-6">
                                <h6>Models:</h6>
                                <ul class="feature-list">
                                    <li><strong>Destination:</strong> Hierarchical destinations (Country ‚Üí City ‚Üí Place)</li>
                                    <li><strong>Package:</strong> Travel packages with pricing and itineraries</li>
                                    <li><strong>Accommodation:</strong> Hotels and lodging options</li>
                                    <li><strong>TravelMode:</strong> Transportation options</li>
                                    <li><strong>PackageBooking:</strong> Booking management</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <h6>Key Features:</h6>
                                <ul class="feature-list">
                                    <li>Hierarchical destination management</li>
                                    <li>Rich text content with CKEditor</li>
                                    <li>Image management with Uploadcare</li>
                                    <li>SEO optimization fields</li>
                                    <li>Advanced filtering and search</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Blog App -->
                    <div class="mb-5">
                        <h4><i class="fas fa-blog me-2 text-warning"></i>blog App</h4>
                        <p><strong>Purpose:</strong> Content management system for travel blogs and articles.</p>

                        <div class="row">
                            <div class="col-md-6">
                                <h6>Models:</h6>
                                <ul class="feature-list">
                                    <li><strong>Post:</strong> Blog articles with rich content</li>
                                    <li><strong>Category:</strong> Content categorization</li>
                                    <li><strong>Comment:</strong> User engagement system</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <h6>Key Features:</h6>
                                <ul class="feature-list">
                                    <li>Rich text editing with CKEditor</li>
                                    <li>Tag management system</li>
                                    <li>Comment moderation</li>
                                    <li>Publishing workflow</li>
                                    <li>SEO-friendly URLs</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Users App -->
                    <div class="mb-5">
                        <h4><i class="fas fa-users me-2 text-warning"></i>users App</h4>
                        <p><strong>Purpose:</strong> User management, authentication, and booking system.</p>

                        <div class="row">
                            <div class="col-md-6">
                                <h6>Models:</h6>
                                <ul class="feature-list">
                                    <li><strong>UserBookings:</strong> Package booking records</li>
                                    <li><strong>MICEInquiry:</strong> Corporate event inquiries</li>
                                    <li><strong>StudentTravelInquiry:</strong> Educational travel</li>
                                    <li><strong>NGOTravelInquiry:</strong> Non-profit travel</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <h6>Key Features:</h6>
                                <ul class="feature-list">
                                    <li>User registration and authentication</li>
                                    <li>Email verification system</li>
                                    <li>Booking management</li>
                                    <li>Specialized inquiry forms</li>
                                    <li>Email notifications</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- User Journey Section -->
            <section id="user-journey" class="doc-section">
                <div class="doc-card p-4">
                    <h2 class="mb-4" style="color: #0f238d; font-family: 'Fonarto', sans-serif;">
                        <i class="fas fa-route me-3"></i>User Journey Flowchart
                    </h2>

                    <div class="user-journey-section">
                        <p class="lead text-center mb-4">
                            Complete user flow diagram showing guest, registered user, and admin journeys
                        </p>

                        <!-- Embedded Mermaid Flowchart -->
                        <div class="flowchart-container">
                            <div id="user-journey-diagram"></div>
                        </div>

                        <!-- User Journey Explanations -->
                        <div class="row mt-5">
                            <div class="col-md-4">
                                <div class="doc-card p-3 h-100">
                                    <h5><i class="fas fa-user me-2 text-primary"></i>Guest User Journey</h5>
                                    <ul class="feature-list">
                                        <li>Browse destinations and packages</li>
                                        <li>Read travel blog content</li>
                                        <li>Submit specialized inquiries (MICE, Student, NGO)</li>
                                        <li>Register for booking access</li>
                                        <li>Contact through various forms</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="doc-card p-3 h-100">
                                    <h5><i class="fas fa-user-check me-2 text-success"></i>Registered User Journey</h5>
                                    <ul class="feature-list">
                                        <li>Login with email verification</li>
                                        <li>Access enhanced booking features</li>
                                        <li>Complete package bookings</li>
                                        <li>Receive email confirmations</li>
                                        <li>Manage booking preferences</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="doc-card p-3 h-100">
                                    <h5><i class="fas fa-user-cog me-2 text-warning"></i>Admin User Journey</h5>
                                    <ul class="feature-list">
                                        <li>Manage destinations and packages</li>
                                        <li>Create and publish blog content</li>
                                        <li>Process bookings and inquiries</li>
                                        <li>Monitor system statistics</li>
                                        <li>Configure site settings</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- Decision Points -->
                        <div class="mt-5">
                            <h4><i class="fas fa-decision me-2 text-warning"></i>Key Decision Points</h4>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="doc-card p-3">
                                        <h6>Authentication Gates</h6>
                                        <p>Users must register and login to access booking functionality, ensuring secure transactions and personalized experiences.</p>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="doc-card p-3">
                                        <h6>Service Selection</h6>
                                        <p>Different inquiry forms route users to appropriate specialized services (MICE, Student, NGO travel).</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Admin Guide Section -->
            <section id="admin-guide" class="doc-section">
                <div class="doc-card p-4">
                    <h2 class="mb-4" style="color: #0f238d; font-family: 'Fonarto', sans-serif;">
                        <i class="fas fa-cog me-3"></i>Administrator Guide
                    </h2>

                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>Admin Access:</strong> Use the Django admin interface at <code>/admin/</code> with your administrator credentials.
                    </div>

                    <!-- Content Management -->
                    <div class="mb-5">
                        <h4><i class="fas fa-edit me-2 text-warning"></i>Content Management</h4>

                        <div class="row">
                            <div class="col-md-6">
                                <h6>Destination Management</h6>
                                <ul class="feature-list">
                                    <li>Create hierarchical destinations (Country ‚Üí City ‚Üí Place)</li>
                                    <li>Upload and manage destination images</li>
                                    <li>Write rich text descriptions with CKEditor</li>
                                    <li>Set SEO meta tags and descriptions</li>
                                    <li>Control visibility and featured status</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <h6>Package Management</h6>
                                <ul class="feature-list">
                                    <li>Create comprehensive travel packages</li>
                                    <li>Set pricing and duration</li>
                                    <li>Configure itineraries and inclusions</li>
                                    <li>Manage accommodation options</li>
                                    <li>Control publishing status</li>
                                </ul>
                            </div>
                        </div>

                        <div class="row mt-4">
                            <div class="col-md-6">
                                <h6>Blog Management</h6>
                                <ul class="feature-list">
                                    <li>Create and edit blog posts with rich text</li>
                                    <li>Organize content with categories and tags</li>
                                    <li>Manage publishing workflow (draft ‚Üí review ‚Üí published)</li>
                                    <li>Moderate user comments</li>
                                    <li>Track post views and engagement</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <h6>User Management</h6>
                                <ul class="feature-list">
                                    <li>View and manage user accounts</li>
                                    <li>Process booking requests</li>
                                    <li>Handle specialized inquiries</li>
                                    <li>Send email notifications</li>
                                    <li>Monitor user activity</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- CKEditor Usage -->
                    <div class="mb-5">
                        <h4><i class="fas fa-text-height me-2 text-warning"></i>Rich Text Editor (CKEditor)</h4>
                        <p>The admin interface uses CKEditor for rich text content creation across destinations, packages, and blog posts.</p>

                        <div class="code-block">
Configuration: Simplified 'full' toolbar
Features: Text formatting, links, images, tables, source editing
Height: 300px consistent across all fields
Compatibility: django-ckeditor 6.7.3 + django-js-asset 3.1.2
                        </div>

                        <div class="alert alert-success">
                            <i class="fas fa-check-circle me-2"></i>
                            <strong>Recent Update:</strong> CKEditor configuration has been simplified for better compatibility and easier maintenance.
                        </div>
                    </div>
                </div>
            </section>

            <!-- Technology Stack Section -->
            <section id="tech-stack" class="doc-section">
                <div class="doc-card p-4">
                    <h2 class="mb-4" style="color: #0f238d; font-family: 'Fonarto', sans-serif;">
                        <i class="fas fa-layer-group me-3"></i>Technology Stack
                    </h2>

                    <div class="tech-stack-grid">
                        <div class="tech-item">
                            <div class="tech-icon">
                                <i class="fab fa-python"></i>
                            </div>
                            <h5>Backend</h5>
                            <ul class="list-unstyled">
                                <li><strong>Django 5.0.14</strong></li>
                                <li>Python 3.12</li>
                                <li>PostgreSQL (Neon)</li>
                                <li>Django REST Framework</li>
                            </ul>
                        </div>

                        <div class="tech-item">
                            <div class="tech-icon">
                                <i class="fab fa-html5"></i>
                            </div>
                            <h5>Frontend</h5>
                            <ul class="list-unstyled">
                                <li><strong>Bootstrap 5</strong></li>
                                <li>Custom CSS/SCSS</li>
                                <li>FontAwesome Icons</li>
                                <li>Fonarto Custom Fonts</li>
                            </ul>
                        </div>

                        <div class="tech-item">
                            <div class="tech-icon">
                                <i class="fas fa-edit"></i>
                            </div>
                            <h5>Content Management</h5>
                            <ul class="list-unstyled">
                                <li><strong>django-ckeditor 6.7.3</strong></li>
                                <li>django-js-asset 3.1.2</li>
                                <li>Django Unfold Admin</li>
                                <li>Rich Text Editing</li>
                            </ul>
                        </div>

                        <div class="tech-item">
                            <div class="tech-icon">
                                <i class="fas fa-cloud"></i>
                            </div>
                            <h5>External Services</h5>
                            <ul class="list-unstyled">
                                <li><strong>Uploadcare</strong> (Media)</li>
                                <li>Email Services</li>
                                <li>Neon PostgreSQL</li>
                                <li>Static File Hosting</li>
                            </ul>
                        </div>

                        <div class="tech-item">
                            <div class="tech-icon">
                                <i class="fas fa-tags"></i>
                            </div>
                            <h5>Additional Packages</h5>
                            <ul class="list-unstyled">
                                <li><strong>django-taggit</strong></li>
                                <li>shortuuid</li>
                                <li>pyuploadcare</li>
                                <li>django-crispy-forms</li>
                            </ul>
                        </div>

                        <div class="tech-item">
                            <div class="tech-icon">
                                <i class="fas fa-mobile-alt"></i>
                            </div>
                            <h5>Design Features</h5>
                            <ul class="list-unstyled">
                                <li><strong>Responsive Design</strong></li>
                                <li>Mobile-First Approach</li>
                                <li>Glass Morphism Effects</li>
                                <li>Modern UI/UX</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Key Features Section -->
            <section id="features" class="doc-section">
                <div class="doc-card p-4">
                    <h2 class="mb-4" style="color: #0f238d; font-family: 'Fonarto', sans-serif;">
                        <i class="fas fa-star me-3"></i>Key Features
                    </h2>

                    <div class="row">
                        <div class="col-md-6">
                            <h5><i class="fas fa-map-marked-alt me-2 text-warning"></i>Travel Management</h5>
                            <ul class="feature-list">
                                <li>Hierarchical destination structure</li>
                                <li>Comprehensive package management</li>
                                <li>Accommodation booking system</li>
                                <li>Multiple travel modes</li>
                                <li>Pricing and availability management</li>
                                <li>SEO-optimized content</li>
                            </ul>
                        </div>

                        <div class="col-md-6">
                            <h5><i class="fas fa-users me-2 text-warning"></i>User Experience</h5>
                            <ul class="feature-list">
                                <li>User registration and authentication</li>
                                <li>Email verification system</li>
                                <li>Secure booking process</li>
                                <li>Personalized user dashboard</li>
                                <li>Email notifications</li>
                                <li>Mobile-responsive design</li>
                            </ul>
                        </div>
                    </div>

                    <div class="row mt-4">
                        <div class="col-md-6">
                            <h5><i class="fas fa-blog me-2 text-warning"></i>Content Management</h5>
                            <ul class="feature-list">
                                <li>Rich text blog editor</li>
                                <li>Category and tag system</li>
                                <li>Comment moderation</li>
                                <li>Publishing workflow</li>
                                <li>SEO-friendly URLs</li>
                                <li>Social sharing integration</li>
                            </ul>
                        </div>

                        <div class="col-md-6">
                            <h5><i class="fas fa-briefcase me-2 text-warning"></i>Specialized Services</h5>
                            <ul class="feature-list">
                                <li>MICE (Meetings, Incentives, Conferences, Exhibitions)</li>
                                <li>Student travel programs</li>
                                <li>NGO and sustainable travel</li>
                                <li>Corporate booking management</li>
                                <li>Group travel coordination</li>
                                <li>Custom inquiry forms</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Environment Configuration Section -->
            <section id="environment-config" class="doc-section">
                <div class="doc-card p-4">
                    <h2 class="mb-4" style="color: #0f238d; font-family: 'Fonarto', sans-serif;">
                        <i class="fas fa-cogs me-3"></i>Environment Configuration
                    </h2>

                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>Environment Setup:</strong> Comprehensive configuration for development,
                        testing, and production environments with proper security and performance settings.
                    </div>

                    <!-- Environment Overview -->
                    <div class="mt-4">
                        <h4>Environment Types</h4>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="card border-success mb-3">
                                    <div class="card-header bg-success text-white">
                                        <h6 class="mb-0"><i class="fas fa-laptop-code me-2"></i>Development</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="list-unstyled small">
                                            <li>üóÑÔ∏è SQLite database</li>
                                            <li>üìß Console email backend</li>
                                            <li>üêõ Debug mode enabled</li>
                                            <li>üîß Debug toolbar active</li>
                                            <li>üîí Relaxed security settings</li>
                                            <li>üìù Verbose logging</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card border-warning mb-3">
                                    <div class="card-header bg-warning text-white">
                                        <h6 class="mb-0"><i class="fas fa-vial me-2"></i>Testing</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="list-unstyled small">
                                            <li>üíæ In-memory SQLite</li>
                                            <li>üìß Local email backend</li>
                                            <li>üö´ Migrations disabled</li>
                                            <li>‚ö° Fast password hashing</li>
                                            <li>üîá Minimal logging</li>
                                            <li>üß™ Test-specific settings</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card border-danger mb-3">
                                    <div class="card-header bg-danger text-white">
                                        <h6 class="mb-0"><i class="fas fa-server me-2"></i>Production</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="list-unstyled small">
                                            <li>üêò PostgreSQL (NeonDB)</li>
                                            <li>üìß SMTP email backend</li>
                                            <li>üö´ Debug mode disabled</li>
                                            <li>üîí Security hardening</li>
                                            <li>üìä Performance optimization</li>
                                            <li>üîç Error monitoring</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Required Environment Variables -->
                    <div class="mt-4">
                        <h4>Required Environment Variables</h4>
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead class="table-dark">
                                    <tr>
                                        <th>Variable</th>
                                        <th>Purpose</th>
                                        <th>Example Value</th>
                                        <th>Required</th>
                                        <th>Environment</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><code>SECRET_KEY</code></td>
                                        <td>Django cryptographic signing</td>
                                        <td>django-insecure-xyz...</td>
                                        <td><span class="badge bg-danger">Yes</span></td>
                                        <td>All</td>
                                    </tr>
                                    <tr>
                                        <td><code>DATABASE_URL</code></td>
                                        <td>Database connection string</td>
                                        <td>postgresql://user:pass@host:port/db</td>
                                        <td><span class="badge bg-danger">Yes</span></td>
                                        <td>Production</td>
                                    </tr>
                                    <tr>
                                        <td><code>EMAIL_HOST_USER</code></td>
                                        <td>SMTP authentication username</td>
                                        <td>dedeexpeditions@gmail.com</td>
                                        <td><span class="badge bg-danger">Yes</span></td>
                                        <td>Production</td>
                                    </tr>
                                    <tr>
                                        <td><code>EMAIL_HOST_PASSWORD</code></td>
                                        <td>Gmail app password</td>
                                        <td>iagt yans hoyd pavg</td>
                                        <td><span class="badge bg-danger">Yes</span></td>
                                        <td>Production</td>
                                    </tr>
                                    <tr>
                                        <td><code>UPLOADCARE_PUBLIC_KEY</code></td>
                                        <td>Uploadcare image service</td>
                                        <td>demopublickey</td>
                                        <td><span class="badge bg-danger">Yes</span></td>
                                        <td>All</td>
                                    </tr>
                                    <tr>
                                        <td><code>UPLOADCARE_SECRET_KEY</code></td>
                                        <td>Uploadcare authentication</td>
                                        <td>demosecretkey</td>
                                        <td><span class="badge bg-danger">Yes</span></td>
                                        <td>All</td>
                                    </tr>
                                    <tr>
                                        <td><code>SITE_URL</code></td>
                                        <td>Base site URL for links</td>
                                        <td>https://mbuganiluxeadventures.onrender.com</td>
                                        <td><span class="badge bg-warning">Recommended</span></td>
                                        <td>Production</td>
                                    </tr>
                                    <tr>
                                        <td><code>WHATSAPP_PHONE</code></td>
                                        <td>WhatsApp contact number</td>
                                        <td>+254701363551</td>
                                        <td><span class="badge bg-info">Optional</span></td>
                                        <td>All</td>
                                    </tr>
                                    <tr>
                                        <td><code>SENTRY_DSN</code></td>
                                        <td>Error monitoring service</td>
                                        <td>https://sentry.io/dsn/...</td>
                                        <td><span class="badge bg-info">Optional</span></td>
                                        <td>Production</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Production Environment File -->
                    <div class="mt-4">
                        <h4>Production Environment Configuration</h4>
                        <div class="row">
                            <div class="col-md-6">
                                <h5>Core Settings</h5>
                                <div class="code-block small">
# Django Core
DJANGO_SETTINGS_MODULE=tours_travels.settings_prod
SECRET_KEY=your-super-secret-key-here
DEBUG=False
ALLOWED_HOSTS=mbuganiluxeadventures.onrender.com,.onrender.com

# Database (Supabase PostgreSQL)
DATABASE_URL=postgresql://postgres.zgwfxeemdgfryiulbapx:JDuH37tYEfVuPpX!@aws-1-eu-west-1.pooler.supabase.com:6543/postgres

# Email Configuration
EMAIL_HOST_USER=novustellke@gmail.com
EMAIL_HOST_PASSWORD=iagt yans hoyd pavg
DEFAULT_FROM_EMAIL=Novustell Travel <novustellke@gmail.com>
ADMIN_EMAIL=info@mbuganiluxeadventures.com
JOBS_EMAIL=careers@mbuganiluxeadventures.com
NEWSLETTER_EMAIL=news@mbuganiluxeadventures.com
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h5>Services & Security</h5>
                                <div class="code-block small">
# Uploadcare
UPLOADCARE_PUBLIC_KEY=your-uploadcare-public-key
UPLOADCARE_SECRET_KEY=your-uploadcare-secret-key

# Site Configuration
SITE_URL=https://mbuganiluxeadventures.onrender.com
WHATSAPP_PHONE=+254701363551

# Security
SECURE_SSL_REDIRECT=True
SECURE_HSTS_SECONDS=31536000
SESSION_COOKIE_SECURE=True
CSRF_COOKIE_SECURE=True

# Performance
WEB_CONCURRENCY=3
GUNICORN_WORKERS=3
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Render.yaml Configuration -->
                    <div class="mt-4">
                        <h4>Render Deployment Configuration</h4>
                        <div class="code-block">
services:
  - type: web
    name: novustell-travel
    env: python
    region: oregon
    plan: starter
    branch: wearelive
    buildCommand: |
      pip install --upgrade pip
      pip install -r requirements.txt
      python manage.py collectstatic --noinput --settings=tours_travels.settings_prod
      python manage.py migrate --settings=tours_travels.settings_prod
    startCommand: |
      gunicorn tours_travels.wsgi:application --bind 0.0.0.0:$PORT --workers 3
    healthCheckPath: /health/
    autoDeploy: true

# External Database Configuration (Supabase)
# No database creation needed - using external Supabase PostgreSQL
# DATABASE_URL environment variable contains connection string
                        </div>
                    </div>

                    <!-- Security Configuration -->
                    <div class="mt-4">
                        <h4>Security Configuration</h4>
                        <div class="row">
                            <div class="col-md-6">
                                <h5>HTTPS & SSL</h5>
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item">üîí SSL redirect enabled</li>
                                    <li class="list-group-item">üõ°Ô∏è HSTS headers configured</li>
                                    <li class="list-group-item">üç™ Secure cookies enforced</li>
                                    <li class="list-group-item">üîê CSRF protection active</li>
                                    <li class="list-group-item">üö´ XSS protection enabled</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <h5>Content Security</h5>
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item">üìã Content Security Policy</li>
                                    <li class="list-group-item">üîç X-Content-Type-Options</li>
                                    <li class="list-group-item">üñºÔ∏è X-Frame-Options: DENY</li>
                                    <li class="list-group-item">üîí Referrer Policy configured</li>
                                    <li class="list-group-item">üõ°Ô∏è Permissions Policy set</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Improvement Recommendations Section -->
            <section id="improvements" class="doc-section">
                <div class="doc-card p-4">
                    <h2 class="mb-4" style="color: #0f238d; font-family: 'Fonarto', sans-serif;">
                        <i class="fas fa-lightbulb me-3"></i>Improvement Recommendations
                    </h2>

                    <div class="alert alert-success">
                        <i class="fas fa-chart-line me-2"></i>
                        <strong>Enhancement Opportunities:</strong> Strategic recommendations for performance,
                        security, user experience, and feature improvements to elevate the booking system.
                    </div>

                    <!-- Performance Improvements -->
                    <div class="mt-4">
                        <h4>Performance Optimization</h4>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card border-primary mb-3">
                                    <div class="card-header bg-primary text-white">
                                        <h6 class="mb-0">üöÄ Database Optimization</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="list-unstyled small">
                                            <li>‚ú® Implement database query optimization</li>
                                            <li>üìä Add database indexing for search fields</li>
                                            <li>üîÑ Implement query result caching</li>
                                            <li>üìà Add database connection pooling</li>
                                            <li>üóÉÔ∏è Implement database query monitoring</li>
                                            <li>‚ö° Use select_related and prefetch_related</li>
                                        </ul>
                                        <p class="text-muted small"><strong>Impact:</strong> 40-60% faster page loads</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card border-info mb-3">
                                    <div class="card-header bg-info text-white">
                                        <h6 class="mb-0">‚ö° Caching Strategy</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="list-unstyled small">
                                            <li>üóÑÔ∏è Implement Redis caching layer</li>
                                            <li>üìÑ Add template fragment caching</li>
                                            <li>üñºÔ∏è Implement image CDN integration</li>
                                            <li>üìä Cache expensive database queries</li>
                                            <li>üåê Add browser caching headers</li>
                                            <li>üì± Implement service worker caching</li>
                                        </ul>
                                        <p class="text-muted small"><strong>Impact:</strong> 70-80% faster repeat visits</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Security Enhancements -->
                    <div class="mt-4">
                        <h4>Security Enhancements</h4>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="card border-danger mb-3">
                                    <div class="card-header bg-danger text-white">
                                        <h6 class="mb-0">üî¥ High Priority</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="list-unstyled small">
                                            <li>üîê Two-factor authentication</li>
                                            <li>üõ°Ô∏è Web Application Firewall</li>
                                            <li>üìä Security monitoring & alerting</li>
                                            <li>üîç Comprehensive audit logging</li>
                                            <li>‚ö° Rate limiting implementation</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card border-warning mb-3">
                                    <div class="card-header bg-warning text-white">
                                        <h6 class="mb-0">üü° Medium Priority</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="list-unstyled small">
                                            <li>üìß Email verification system</li>
                                            <li>üåç IP-based access controls</li>
                                            <li>üîÑ Enhanced session management</li>
                                            <li>üîê Password strength enforcement</li>
                                            <li>üì± Device fingerprinting</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card border-success mb-3">
                                    <div class="card-header bg-success text-white">
                                        <h6 class="mb-0">üü¢ Low Priority</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="list-unstyled small">
                                            <li>üìß Email encryption (PGP)</li>
                                            <li>üîç Advanced threat detection</li>
                                            <li>üîê Hardware security keys</li>
                                            <li>üõ°Ô∏è Zero-trust architecture</li>
                                            <li>üìä Behavioral analytics</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- User Experience Improvements -->
                    <div class="mt-4">
                        <h4>User Experience Enhancements</h4>
                        <div class="row">
                            <div class="col-md-6">
                                <h5>Booking Experience</h5>
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item">üéØ Smart package recommendations</li>
                                    <li class="list-group-item">üìÖ Real-time availability calendar</li>
                                    <li class="list-group-item">üí∞ Dynamic pricing display</li>
                                    <li class="list-group-item">üîÑ One-click rebooking</li>
                                    <li class="list-group-item">üì± Progressive Web App (PWA)</li>
                                    <li class="list-group-item">üó£Ô∏è Multi-language support</li>
                                    <li class="list-group-item">‚ôø Enhanced accessibility features</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <h5>Communication Features</h5>
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item">üí¨ Live chat integration</li>
                                    <li class="list-group-item">üìû Click-to-call functionality</li>
                                    <li class="list-group-item">üìß Automated email sequences</li>
                                    <li class="list-group-item">üì± SMS notifications</li>
                                    <li class="list-group-item">üîî Push notifications</li>
                                    <li class="list-group-item">üìä Booking status tracking</li>
                                    <li class="list-group-item">‚≠ê Review and rating system</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Feature Additions -->
                    <div class="mt-4">
                        <h4>Additional Feature Recommendations</h4>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="card border-primary mb-3">
                                    <div class="card-header bg-primary text-white">
                                        <h6 class="mb-0">üí≥ Payment Integration</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="list-unstyled small">
                                            <li>üí≥ Stripe payment gateway</li>
                                            <li>üè¶ M-Pesa integration</li>
                                            <li>üí∞ PayPal support</li>
                                            <li>üì± Mobile money options</li>
                                            <li>üí∏ Installment payments</li>
                                            <li>üé´ Digital receipts</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card border-success mb-3">
                                    <div class="card-header bg-success text-white">
                                        <h6 class="mb-0">üìä Analytics & Insights</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="list-unstyled small">
                                            <li>üìà Google Analytics 4</li>
                                            <li>üî• Hotjar user behavior</li>
                                            <li>üìä Custom dashboard metrics</li>
                                            <li>üéØ Conversion tracking</li>
                                            <li>üì± Mobile app analytics</li>
                                            <li>üí∞ Revenue reporting</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card border-warning mb-3">
                                    <div class="card-header bg-warning text-white">
                                        <h6 class="mb-0">ü§ñ Automation</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="list-unstyled small">
                                            <li>ü§ñ Chatbot integration</li>
                                            <li>üìß Email marketing automation</li>
                                            <li>üìÖ Automated reminders</li>
                                            <li>üîÑ Booking follow-ups</li>
                                            <li>üìä Automated reporting</li>
                                            <li>üéØ Personalized recommendations</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Implementation Timeline -->
                    <div class="mt-4">
                        <h4>Recommended Implementation Timeline</h4>
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead class="table-dark">
                                    <tr>
                                        <th>Phase</th>
                                        <th>Duration</th>
                                        <th>Priority Features</th>
                                        <th>Expected Impact</th>
                                        <th>Resources Required</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>Phase 1</strong><br><small>Security & Performance</small></td>
                                        <td>2-3 weeks</td>
                                        <td>Rate limiting, caching, database optimization</td>
                                        <td>50% performance improvement</td>
                                        <td>1 Backend Developer</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Phase 2</strong><br><small>Payment Integration</small></td>
                                        <td>3-4 weeks</td>
                                        <td>Stripe, M-Pesa, PayPal integration</td>
                                        <td>Complete booking automation</td>
                                        <td>1 Full-stack Developer</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Phase 3</strong><br><small>User Experience</small></td>
                                        <td>4-5 weeks</td>
                                        <td>PWA, live chat, recommendations</td>
                                        <td>30% conversion increase</td>
                                        <td>1 Frontend + 1 Backend Developer</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Phase 4</strong><br><small>Analytics & Automation</small></td>
                                        <td>2-3 weeks</td>
                                        <td>Analytics, chatbot, email automation</td>
                                        <td>Data-driven optimization</td>
                                        <td>1 Developer + Marketing</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Deployment Section -->
            <section id="deployment" class="doc-section">
                <div class="doc-card p-4">
                    <h2 class="mb-4" style="color: #0f238d; font-family: 'Fonarto', sans-serif;">
                        <i class="fas fa-rocket me-3"></i>Deployment Information
                    </h2>

                    <div class="row">
                        <div class="col-md-6">
                            <h5><i class="fas fa-server me-2 text-warning"></i>Environment Setup</h5>
                            <div class="code-block">
# Virtual Environment
python -m venv env
source env/bin/activate  # Linux/Mac
env\Scripts\activate     # Windows

# Install Dependencies
pip install -r requirements.txt

# Database Migration
python manage.py migrate

# Create Superuser
python manage.py createsuperuser

# Run Development Server
python manage.py runserver
                            </div>
                        </div>

                        <div class="col-md-6">
                            <h5><i class="fas fa-database me-2 text-warning"></i>Database Configuration</h5>
                            <div class="code-block">
# PostgreSQL (Supabase Cloud)
DATABASE_URL=postgresql://postgres.zgwfxeemdgfryiulbapx:JDuH37tYEfVuPpX!@aws-1-eu-west-1.pooler.supabase.com:6543/postgres

# Environment Variables
DEBUG=False
SECRET_KEY=your-secret-key
ALLOWED_HOSTS=your-domain.com

# Media Storage
UPLOADCARE_PUBLIC_KEY=your-key
UPLOADCARE_SECRET_KEY=your-secret

# Email Configuration
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_USE_TLS=True
                            </div>
                        </div>
                    </div>

                    <div class="alert alert-warning mt-4">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        <strong>Security Note:</strong> Always use environment variables for sensitive configuration in production.
                    </div>
                </div>
            </section>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<!-- Mermaid.js for flowchart -->
<script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Initialize Mermaid
    mermaid.initialize({
        startOnLoad: true,
        theme: 'default',
        flowchart: {
            useMaxWidth: true,
            htmlLabels: true,
            curve: 'basis'
        }
    });

    // User Journey Flowchart
    const userJourneyDiagram = `
    flowchart TD
        A[üè† Homepage] --> B{User Type?}

        %% Guest User Journey
        B -->|Guest| C[Browse Destinations]
        B -->|Guest| D[Browse Packages]
        B -->|Guest| E[Read Blog]
        B -->|Guest| F[Contact Us]

        C --> C1[View Destination Details]
        C1 --> C2[See Related Packages]
        C2 --> G[Package Details]

        D --> G[Package Details]
        G --> H{Want to Book?}
        H -->|Yes| I[Register/Login Required]
        H -->|No| J[Continue Browsing]

        E --> E1[Read Blog Post]
        E1 --> E2[Leave Comment]
        E2 --> E3[Comment Moderation]

        F --> F1[Contact Form]
        F1 --> F2[MICE Inquiry]
        F1 --> F3[Student Travel]
        F1 --> F4[NGO Travel]

        %% Registered User Journey
        B -->|Registered| K[Login]
        K --> L[Authenticated Dashboard]
        L --> M[Browse with Booking Access]
        M --> G

        I --> N[Registration Form]
        N --> O[Email Verification]
        O --> P[Account Activated]
        P --> K

        %% Booking Process
        H -->|Logged In| Q[Booking Form]
        Q --> R[Select Options]
        R --> R1[Choose Accommodation]
        R --> R2[Choose Travel Mode]
        R --> R3[Specify Guests]
        R --> R4[Special Requests]
        R1 --> S[Review Booking]
        R2 --> S
        R3 --> S
        R4 --> S
        S --> T[Confirm Booking]
        T --> U[Payment Process]
        U --> V[Booking Confirmation]
        V --> W[Email Confirmation]

        %% Admin Journey
        B -->|Admin| X[Admin Login]
        X --> Y[Admin Dashboard]
        Y --> Z[Content Management]

        Z --> Z1[Manage Destinations]
        Z --> Z2[Manage Packages]
        Z --> Z3[Manage Accommodations]
        Z --> Z4[Manage Blog Posts]
        Z --> Z5[Manage Bookings]
        Z --> Z6[Manage Users]

        %% Specialized Services
        F2 --> F2A[MICE Event Details]
        F2A --> F2B[Corporate Booking]

        F3 --> F3A[Student Group Details]
        F3A --> F3B[Educational Travel]

        F4 --> F4A[NGO Project Details]
        F4A --> F4B[Sustainable Travel]

        %% Success Endpoints
        W --> W1[üìß Email Sent]
        V --> V1[üì± SMS Notification]
        E3 --> E4[‚úÖ Comment Published]
        F1 --> F5[‚úÖ Inquiry Submitted]

        %% Styling
        classDef userAction fill:#e1f5fe,stroke:#01579b,stroke-width:2px
        classDef adminAction fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
        classDef process fill:#e8f5e8,stroke:#1b5e20,stroke-width:2px
        classDef decision fill:#fff3e0,stroke:#e65100,stroke-width:2px
        classDef success fill:#e8f5e8,stroke:#2e7d32,stroke-width:3px

        class A,C,D,E,F,K,L,M userAction
        class X,Y,Z,Z1,Z2,Z3,Z4,Z5,Z6 adminAction
        class N,O,P,Q,R,S,T,U process
        class B,H decision
        class W1,V1,E4,F5 success
    `;

    // Render the flowchart
    mermaid.render('user-journey-mermaid', userJourneyDiagram).then(function(result) {
        document.getElementById('user-journey-diagram').innerHTML = result.svg;
    });

    // Smooth scrolling for navigation links
    document.querySelectorAll('.doc-nav a').forEach(function(link) {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            const targetId = this.getAttribute('href').substring(1);
            const targetElement = document.getElementById(targetId);

            if (targetElement) {
                // Update active link
                document.querySelectorAll('.doc-nav a').forEach(function(navLink) {
                    navLink.classList.remove('active');
                });
                this.classList.add('active');

                // Smooth scroll
                targetElement.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });

    // Update active navigation on scroll
    window.addEventListener('scroll', function() {
        const sections = document.querySelectorAll('section[id]');
        const navLinks = document.querySelectorAll('.doc-nav a');

        let currentSection = '';
        sections.forEach(function(section) {
            const sectionTop = section.offsetTop - 150;
            if (window.pageYOffset >= sectionTop) {
                currentSection = section.getAttribute('id');
            }
        });

        navLinks.forEach(function(link) {
            link.classList.remove('active');
            if (link.getAttribute('href') === '#' + currentSection) {
                link.classList.add('active');
            }
        });
    });

    // Initialize Mermaid diagrams
    if (typeof mermaid !== 'undefined') {
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true
            }
        });

        // Main Application Flow Chart
        const mainFlowChart = `
        flowchart TD
            A[User Visits Website] --> B{User Type?}
            B -->|Guest| C[Browse Packages]
            B -->|Registered| D[Login to Dashboard]

            C --> E[Select Package]
            E --> F[Add to Cart]
            F --> G[Customize Booking]
            G --> H[Enter Details]
            H --> I[Review Summary]
            I --> J[Confirm Booking]

            J --> K{Email Exists?}
            K -->|No| L[Create Account]
            K -->|Yes| M[Link to Existing Account]

            L --> N[Send Welcome Email]
            M --> N
            N --> O[Send Booking Confirmation]
            O --> P[Redirect to Dashboard]

            D --> Q[View Profile]
            Q --> R[Manage Bookings]
            R --> S[Update Bucket List]
            S --> T[Edit Profile]

            style A fill:#e1f5fe
            style J fill:#c8e6c9
            style L fill:#fff3e0
            style N fill:#f3e5f5
            style P fill:#e8f5e8
        `;

        // Booking Process Flow Chart
        const bookingFlowChart = `
        flowchart LR
            A[Package Selection] --> B[Cart Management]
            B --> C[Customization]
            C --> D[Guest Details]
            D --> E[Review & Confirm]
            E --> F[Account Creation]
            F --> G[Email Notifications]

            B1[Add Package] --> B
            B2[Update Quantities] --> B
            B3[Remove Items] --> B

            C1[Select Accommodations] --> C
            C2[Choose Travel Modes] --> C
            C3[Special Requests] --> C

            D1[Personal Information] --> D
            D2[Contact Details] --> D
            D3[Travel Preferences] --> D

            F1[Generate Password] --> F
            F2[Create UserProfile] --> F
            F3[Link Booking] --> F

            style A fill:#ffebee
            style E fill:#e8f5e8
            style F fill:#fff3e0
            style G fill:#f3e5f5
        `;

        // Admin Workflow Chart
        const adminFlowChart = `
        flowchart TD
            A[Admin Login] --> B[Django Admin Dashboard]
            B --> C[Content Management]
            B --> D[Booking Management]
            B --> E[User Management]

            C --> C1[Destinations]
            C --> C2[Packages]
            C --> C3[Accommodations]
            C --> C4[Travel Modes]

            D --> D1[View Bookings]
            D --> D2[Confirm Bookings]
            D --> D3[Manage Payments]
            D --> D4[Generate Reports]

            E --> E1[User Accounts]
            E --> E2[User Profiles]
            E --> E3[Permissions]
            E --> E4[Activity Logs]

            style A fill:#ffebee
            style B fill:#e3f2fd
            style C fill:#f1f8e9
            style D fill:#fff8e1
            style E fill:#fce4ec
        `;

        // Render the flowcharts
        document.getElementById('main-flowchart').innerHTML = '<div class="mermaid">' + mainFlowChart + '</div>';
        document.getElementById('booking-flowchart').innerHTML = '<div class="mermaid">' + bookingFlowChart + '</div>';
        document.getElementById('admin-flowchart').innerHTML = '<div class="mermaid">' + adminFlowChart + '</div>';

        // Re-initialize mermaid for the new diagrams
        mermaid.init();
    }
});
</script>

<!-- Mermaid.js for flowcharts -->
<script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
{% endblock %}
