# üöÄ Render.com Environment Variables Setup Guide

## Quick Reference for Mbugani Luxe Adventures Deployment

---

## üìã **STEP-BY-STEP SETUP**

### **Step 1: Access Render Dashboard**

1. Go to: https://dashboard.render.com
2. Select your **Mbuganiapp** web service
3. Click on **"Environment"** in the left sidebar
4. Click **"Add Environment Variable"** button

---

## ‚úÖ **REQUIRED VARIABLES** (Must be set before deployment)

### **1. DJANGO_SECRET_KEY**
```
Key: DJANGO_SECRET_KEY
Value: [Generate new key - see below]
```

**How to generate:**
```bash
python -c 'from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())'
```

---

### **2. DATABASE_URL**
```
Key: DATABASE_URL
Value: postgresql://postgres.zgwfxeemdgfryiulbapx:YOUR_PASSWORD@aws-0-eu-central-1.pooler.supabase.com:6543/postgres
```

**Where to find:**
- Go to: https://supabase.com/dashboard/project/YOUR_PROJECT/settings/database
- Copy the **Connection Pooling** URL (port 6543)
- Replace `YOUR_PASSWORD` with your actual database password

---

### **3. ALLOWED_HOSTS**
```
Key: ALLOWED_HOSTS
Value: www.mbuganiluxeadventures.com,mbuganiluxeadventures.com,mbuganiapp.onrender.com
```

**Note:** Replace `mbuganiapp.onrender.com` with your actual Render subdomain

---

### **4. CSRF_TRUSTED_ORIGINS**
```
Key: CSRF_TRUSTED_ORIGINS
Value: https://www.mbuganiluxeadventures.com,https://mbuganiluxeadventures.com,https://mbuganiapp.onrender.com
```

**Note:** Must include `https://` prefix

---

### **5. UPLOADCARE_PUBLIC_KEY**
```
Key: UPLOADCARE_PUBLIC_KEY
Value: 6fb55bb425b16d386db6
```

---

### **6. UPLOADCARE_SECRET_KEY**
```
Key: UPLOADCARE_SECRET_KEY
Value: 3086089d3d2ac096684d
```

---

## ‚öôÔ∏è **RECOMMENDED VARIABLES** (Should be set)

### **7. DJANGO_ENV**
```
Key: DJANGO_ENV
Value: production
```

---

### **8. DEBUG**
```
Key: DEBUG
Value: False
```

---

### **9. SITE_URL**
```
Key: SITE_URL
Value: https://www.mbuganiluxeadventures.com
```

---

### **10. DEFAULT_FROM_EMAIL**
```
Key: DEFAULT_FROM_EMAIL
Value: Mbugani Luxe Adventures <info@mbuganiluxeadventures.com>
```

---

### **11. ADMIN_EMAIL**
```
Key: ADMIN_EMAIL
Value: info@mbuganiluxeadventures.com
```

---

### **12. JOBS_EMAIL**
```
Key: JOBS_EMAIL
Value: careers@mbuganiluxeadventures.com
```

---

### **13. NEWSLETTER_EMAIL**
```
Key: NEWSLETTER_EMAIL
Value: news@mbuganiluxeadventures.com
```

---

## üîí **SECURITY VARIABLES** (Recommended for production)

### **14. SECURE_SSL_REDIRECT**
```
Key: SECURE_SSL_REDIRECT
Value: True
```

---

### **15. SESSION_COOKIE_SECURE**
```
Key: SESSION_COOKIE_SECURE
Value: True
```

---

### **16. CSRF_COOKIE_SECURE**
```
Key: CSRF_COOKIE_SECURE
Value: True
```

---

## üìß **EMAIL VARIABLES** (Optional - already hardcoded in settings)

### **17. MAILTRAP_API_TOKEN** (Optional)
```
Key: MAILTRAP_API_TOKEN
Value: 956b51c090fc5c1320bca0c26a394fd5
```

**Note:** This is already hardcoded in `settings_prod.py`. Only set this if you want to override it for security reasons.

---

## üìä **OPTIONAL MONITORING VARIABLES**

### **18. SENTRY_DSN** (Optional - for error monitoring)
```
Key: SENTRY_DSN
Value: https://your-sentry-dsn@sentry.io/your-project-id
```

**Where to get:**
- Sign up at: https://sentry.io
- Create a new Django project
- Copy the DSN from project settings

---

### **19. GOOGLE_ANALYTICS_ID** (Optional)
```
Key: GOOGLE_ANALYTICS_ID
Value: G-XXXXXXXXXX
```

---

## üö´ **DO NOT SET THESE** (Auto-generated by Render)

‚ùå **RENDER_EXTERNAL_HOSTNAME** - Automatically set by Render  
‚ùå **PORT** - Automatically set by Render  
‚ùå **PYTHON_VERSION** - Set in render.yaml

---

## üìù **COPY-PASTE READY FORMAT**

Here's a quick copy-paste format for Render's bulk add feature:

```env
DJANGO_SECRET_KEY=your-generated-secret-key-here
DATABASE_URL=postgresql://postgres.zgwfxeemdgfryiulbapx:YOUR_PASSWORD@aws-0-eu-central-1.pooler.supabase.com:6543/postgres
ALLOWED_HOSTS=www.mbuganiluxeadventures.com,mbuganiluxeadventures.com,mbuganiapp.onrender.com
CSRF_TRUSTED_ORIGINS=https://www.mbuganiluxeadventures.com,https://mbuganiluxeadventures.com,https://mbuganiapp.onrender.com
UPLOADCARE_PUBLIC_KEY=6fb55bb425b16d386db6
UPLOADCARE_SECRET_KEY=3086089d3d2ac096684d
DJANGO_ENV=production
DEBUG=False
SITE_URL=https://www.mbuganiluxeadventures.com
DEFAULT_FROM_EMAIL=Mbugani Luxe Adventures <info@mbuganiluxeadventures.com>
ADMIN_EMAIL=info@mbuganiluxeadventures.com
JOBS_EMAIL=careers@mbuganiluxeadventures.com
NEWSLETTER_EMAIL=news@mbuganiluxeadventures.com
SECURE_SSL_REDIRECT=True
SESSION_COOKIE_SECURE=True
CSRF_COOKIE_SECURE=True
```

---

## ‚úÖ **VERIFICATION CHECKLIST**

After adding all variables:

- [ ] All required variables are set
- [ ] DATABASE_URL is correct (test connection)
- [ ] ALLOWED_HOSTS includes all your domains
- [ ] CSRF_TRUSTED_ORIGINS has `https://` prefix
- [ ] DEBUG is set to `False`
- [ ] DJANGO_ENV is set to `production`
- [ ] Email addresses are correct
- [ ] Uploadcare credentials are correct
- [ ] Click **"Save Changes"** in Render dashboard

---

## üîÑ **DEPLOYMENT PROCESS**

1. **Add all environment variables** in Render dashboard
2. **Save changes** - This will trigger a new deployment
3. **Monitor deployment logs** - Look for:
   - `üìß Email: Mailtrap HTTP API (synchronous)`
   - `‚úÖ Production settings loaded successfully`
4. **Test the deployment:**
   - Visit your website
   - Submit a quote request
   - Check Mailtrap inbox for emails
   - Test newsletter subscription

---

## üÜò **TROUBLESHOOTING**

### **Issue: Database connection failed**
- ‚úÖ Check DATABASE_URL is correct
- ‚úÖ Verify Supabase database is running
- ‚úÖ Check password is correct (no special characters issues)

### **Issue: Static files not loading**
- ‚úÖ Check ALLOWED_HOSTS includes your domain
- ‚úÖ Verify SITE_URL is correct
- ‚úÖ Check Render build logs for collectstatic errors

### **Issue: CSRF verification failed**
- ‚úÖ Check CSRF_TRUSTED_ORIGINS includes `https://` prefix
- ‚úÖ Verify all your domains are listed
- ‚úÖ Clear browser cookies and try again

### **Issue: Emails not sending**
- ‚úÖ Check Mailtrap API token is correct
- ‚úÖ Verify email addresses are correct
- ‚úÖ Check Render logs for email errors
- ‚úÖ Test with the test script: `python test_mailtrap_email.py`

---

## üìû **SUPPORT**

If you encounter issues:

1. **Check Render Logs:**
   - Dashboard > Your Service > Logs
   - Look for error messages

2. **Check Mailtrap Dashboard:**
   - https://mailtrap.io/inboxes
   - Verify emails are being sent

3. **Test Locally:**
   - Run: `export DJANGO_ENV=production && python test_mailtrap_email.py`
   - Verify all tests pass

---

## üéØ **QUICK START COMMANDS**

### **Generate Django Secret Key:**
```bash
python -c 'from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())'
```

### **Test Email Sending:**
```bash
export DJANGO_ENV=production
python test_mailtrap_email.py
```

### **Check Current Environment:**
```bash
python manage.py shell
>>> from django.conf import settings
>>> print(f"DEBUG: {settings.DEBUG}")
>>> print(f"ALLOWED_HOSTS: {settings.ALLOWED_HOSTS}")
>>> print(f"DATABASE: {settings.DATABASES['default']['NAME']}")
```

---

**Last Updated:** 2025-10-17  
**Version:** 1.0 (Mailtrap HTTP API Migration)

